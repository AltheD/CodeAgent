# 动态缺陷检测系统

## 项目概述

这是一个简化版的动态缺陷检测系统，专为3周开发周期设计，确保核心功能能够实现。

## 核心功能

### ✅ 已实现功能
- **系统监控**: CPU、内存、磁盘使用率监控
- **项目运行**: 自动解压和运行项目
- **运行时分析**: 监控项目执行过程
- **综合检测**: 结合静态和动态检测结果
- **Web界面**: 简洁的用户界面

## 快速开始

### 1. 安装依赖
```bash
pip install fastapi uvicorn psutil
```

### 2. 启动服务
```bash
python start_dynamic_detection.py
```

### 3. 访问界面
- API文档: http://localhost:8003/docs
- 前端界面: 打开 `frontend/dynamic_detection.html`
- 健康检查: http://localhost:8003/health

## 系统架构

### 核心组件
```
agents/
├── simple_monitor_agent.py      # 简化监控Agent
├── integrated_detector.py       # 集成检测器

utils/
└── project_runner.py            # 项目运行器

api/
└── simple_dynamic_api.py        # 简化API

frontend/
└── dynamic_detection.html       # 前端界面
```

### 工作流程
1. 用户上传项目压缩包
2. 系统解压项目
3. 运行项目并监控
4. 收集系统指标
5. 分析检测结果
6. 生成综合报告

## 使用说明

### 1. 上传项目
- 支持ZIP格式压缩包
- 最大100MB
- 自动查找主文件（main.py, app.py等）

### 2. 选择检测选项
- **静态分析**: 分析代码结构和语法
- **动态监控**: 监控系统资源使用
- **运行时分析**: 运行项目并分析执行过程

### 3. 查看结果
- **检测摘要**: 总问题数、严重程度分布
- **问题列表**: 详细的问题信息
- **修复建议**: 针对性的改进建议
- **详细信息**: 项目信息和检测详情

## API接口

### 主要接口
- `POST /api/dynamic-detect` - 动态缺陷检测
- `GET /api/detection-status` - 获取检测状态
- `GET /health` - 健康检查

### 请求示例
```bash
curl -X POST "http://localhost:8003/api/dynamic-detect" \
     -F "file=@project.zip" \
     -F "static_analysis=true" \
     -F "dynamic_monitoring=true" \
     -F "runtime_analysis=true"
```

## 检测能力

### 静态分析
- 代码结构分析
- 语法错误检测
- 安全问题识别
- 代码质量评估

### 动态监控
- CPU使用率监控
- 内存使用率监控
- 磁盘使用率监控
- 系统资源告警

### 运行时分析
- 项目执行监控
- 错误日志分析
- 性能指标收集
- 异常行为检测

## 技术特点

### 简化设计
- 使用成熟技术栈
- 避免复杂架构
- 专注核心功能
- 易于维护和扩展

### 实用功能
- 实时监控
- 智能告警
- 综合报告
- 用户友好界面

### 性能优化
- 异步处理
- 资源控制
- 错误处理
- 自动清理

## 开发计划

### 第1周：基础监控系统
- [x] 创建简化监控Agent
- [x] 实现系统资源监控
- [x] 添加简单告警机制
- [x] 创建基础API接口

### 第2周：项目运行监控
- [x] 实现项目解压功能
- [x] 添加项目运行器
- [x] 实现运行时监控
- [x] 添加错误检测

### 第3周：集成和优化
- [x] 集成静态和动态检测
- [x] 完善用户界面
- [x] 优化用户体验
- [x] 添加文档和测试

## 故障排除

### 常见问题

#### 1. 服务启动失败
```bash
# 检查端口是否被占用
netstat -an | grep 8003

# 检查依赖是否安装
pip list | grep fastapi
```

#### 2. 项目运行失败
- 检查项目是否包含可执行文件
- 确认Python环境正确
- 查看错误日志

#### 3. 监控数据异常
- 检查系统权限
- 确认psutil库正常
- 查看监控日志

## 扩展功能

### 未来改进
- 支持更多项目类型
- 添加更多检测规则
- 集成第三方工具
- 优化性能分析

## 许可证

MIT License