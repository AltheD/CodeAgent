{
  "task_66c7ac13ced1": {
    "task_id": "task_66c7ac13ced1",
    "status": "completed",
    "created_at": "2025-09-28T15:42:55.938206",
    "started_at": "2025-09-28T15:42:55.938206",
    "result": {
      "success": true,
      "task_id": "task_66c7ac13ced1",
      "detection_results": {
        "file_path": "uploads\\test_api_upload.py",
        "language": "python",
        "total_issues": 10,
        "issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 5,
            "file": "test_api_upload.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_api_upload.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 8,
            "file": "test_api_upload.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def function_without_docstring():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_api_upload.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 5,
            "file": "test_api_upload.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_api_upload.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 8,
            "file": "test_api_upload.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def function_without_docstring():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_api_upload.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: os",
            "line": 2,
            "file": "test_api_upload.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# 测试API上传的代码",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": true
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_api_upload.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: sys",
            "line": 3,
            "file": "test_api_upload.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# 测试API上传的代码",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": true
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_api_upload.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 7,
            "file": "test_api_upload.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def function_without_docstring():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_api_upload.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "缺少参数验证",
            "line": 7,
            "file": "test_api_upload.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def function_without_docstring():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_api_upload.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "缺少参数验证",
            "line": 10,
            "file": "test_api_upload.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def function_without_docstring():",
                "is_issue_line": true
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_api_upload.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "MEDIUM",
            "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
            "file": "test_api_upload.py",
            "line": 8,
            "column": 0,
            "rule": "B307",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def function_without_docstring():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "uploads\\test_api_upload.py",
            "enhanced": true
          }
        ],
        "detection_tools": [
          "custom_analyzer",
          "bandit",
          "mypy"
        ],
        "analysis_time": 1.540573,
        "summary": {
          "error_count": 4,
          "warning_count": 2,
          "info_count": 3
        },
        "enhanced": true
      },
      "report": {
        "summary": {
          "error_count": 4,
          "warning_count": 2,
          "info_count": 3
        },
        "issues_by_type": {
          "hardcoded_secrets": 2,
          "unsafe_eval": 2,
          "unused_import": 2,
          "missing_docstring": 1,
          "missing_parameter_validation": 2,
          "bandit": 1
        },
        "issues_by_severity": {
          "error": 4,
          "warning": 2,
          "info": 3
        },
        "recommendations": [
          "发现严重错误，建议优先修复"
        ],
        "priority_issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 5,
            "file": "test_api_upload.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_api_upload.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 8,
            "file": "test_api_upload.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def function_without_docstring():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_api_upload.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 5,
            "file": "test_api_upload.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_api_upload.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 8,
            "file": "test_api_upload.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def function_without_docstring():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_api_upload.py",
            "enhanced": true
          }
        ]
      },
      "timestamp": "2025-09-28T15:42:57.481743"
    },
    "error": null,
    "completed_at": "2025-09-28T15:42:57.481743"
  },
  "task_ffcab53a9388": {
    "task_id": "task_ffcab53a9388",
    "status": "completed",
    "created_at": "2025-09-28T15:43:33.972631",
    "started_at": "2025-09-28T15:43:33.972631",
    "result": {
      "success": true,
      "task_id": "task_ffcab53a9388",
      "detection_results": {
        "file_path": "uploads\\test_frontend.py",
        "language": "python",
        "total_issues": 10,
        "issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 5,
            "file": "test_frontend.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"frontend_test_secret\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(\"1+1\")  # 不安全的eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_frontend.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 8,
            "file": "test_frontend.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "API_KEY = \"frontend_test_secret\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(\"1+1\")  # 不安全的eval",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def missing_docstring():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_frontend.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 5,
            "file": "test_frontend.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"frontend_test_secret\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(\"1+1\")  # 不安全的eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_frontend.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 8,
            "file": "test_frontend.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "API_KEY = \"frontend_test_secret\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(\"1+1\")  # 不安全的eval",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def missing_docstring():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_frontend.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: os",
            "line": 2,
            "file": "test_frontend.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# 前端测试代码",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": true
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"frontend_test_secret\"  # 硬编码密钥",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_frontend.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: sys",
            "line": 3,
            "file": "test_frontend.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# 前端测试代码",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": true
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"frontend_test_secret\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_frontend.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 7,
            "file": "test_frontend.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"frontend_test_secret\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def test_function():",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "    return eval(\"1+1\")  # 不安全的eval",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def missing_docstring():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_frontend.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "缺少参数验证",
            "line": 7,
            "file": "test_frontend.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"frontend_test_secret\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def test_function():",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "    return eval(\"1+1\")  # 不安全的eval",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def missing_docstring():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_frontend.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "缺少参数验证",
            "line": 10,
            "file": "test_frontend.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 7,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(\"1+1\")  # 不安全的eval",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def missing_docstring():",
                "is_issue_line": true
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_frontend.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "MEDIUM",
            "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
            "file": "test_frontend.py",
            "line": 8,
            "column": 0,
            "rule": "B307",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 5,
                "content": "API_KEY = \"frontend_test_secret\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(\"1+1\")  # 不安全的eval",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def missing_docstring():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "uploads\\test_frontend.py",
            "enhanced": true
          }
        ],
        "detection_tools": [
          "custom_analyzer",
          "bandit",
          "mypy"
        ],
        "analysis_time": 1.8536839999999999,
        "summary": {
          "error_count": 4,
          "warning_count": 2,
          "info_count": 3
        },
        "enhanced": true
      },
      "report": {
        "summary": {
          "error_count": 4,
          "warning_count": 2,
          "info_count": 3
        },
        "issues_by_type": {
          "hardcoded_secrets": 2,
          "unsafe_eval": 2,
          "unused_import": 2,
          "missing_docstring": 1,
          "missing_parameter_validation": 2,
          "bandit": 1
        },
        "issues_by_severity": {
          "error": 4,
          "warning": 2,
          "info": 3
        },
        "recommendations": [
          "发现严重错误，建议优先修复"
        ],
        "priority_issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 5,
            "file": "test_frontend.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"frontend_test_secret\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(\"1+1\")  # 不安全的eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_frontend.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 8,
            "file": "test_frontend.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "API_KEY = \"frontend_test_secret\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(\"1+1\")  # 不安全的eval",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def missing_docstring():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_frontend.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 5,
            "file": "test_frontend.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"frontend_test_secret\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(\"1+1\")  # 不安全的eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_frontend.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 8,
            "file": "test_frontend.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "API_KEY = \"frontend_test_secret\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(\"1+1\")  # 不安全的eval",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def missing_docstring():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_frontend.py",
            "enhanced": true
          }
        ]
      },
      "timestamp": "2025-09-28T15:43:35.830485"
    },
    "error": null,
    "completed_at": "2025-09-28T15:43:35.830485"
  },
  "task_782634e594b3": {
    "task_id": "task_782634e594b3",
    "status": "completed",
    "created_at": "2025-09-28T15:44:27.437200",
    "started_at": "2025-09-28T15:44:27.437200",
    "result": {
      "success": true,
      "task_id": "task_782634e594b3",
      "detection_results": {
        "file_path": "uploads\\test_python.py",
        "language": "python",
        "total_issues": 0,
        "issues": [],
        "detection_tools": [
          "custom_analyzer",
          "pylint",
          "flake8",
          "bandit",
          "mypy"
        ],
        "analysis_time": 1.229149,
        "summary": {
          "error_count": 0,
          "warning_count": 0,
          "info_count": 0
        },
        "enhanced": true
      },
      "report": {
        "summary": {
          "error_count": 0,
          "warning_count": 0,
          "info_count": 0
        },
        "issues_by_type": {},
        "issues_by_severity": {
          "error": 0,
          "warning": 0,
          "info": 0
        },
        "recommendations": [],
        "priority_issues": []
      },
      "timestamp": "2025-09-28T15:44:28.684872"
    },
    "error": null,
    "completed_at": "2025-09-28T15:44:28.684872"
  },
  "task_9f27cf0f3b94": {
    "task_id": "task_9f27cf0f3b94",
    "status": "completed",
    "created_at": "2025-09-28T15:44:46.181308",
    "started_at": "2025-09-28T15:44:46.181308",
    "result": {
      "success": true,
      "task_id": "task_9f27cf0f3b94",
      "detection_results": {
        "file_path": "uploads\\test_python.py",
        "language": "python",
        "total_issues": 0,
        "issues": [],
        "detection_tools": [
          "custom_analyzer",
          "pylint",
          "flake8",
          "bandit",
          "mypy"
        ],
        "analysis_time": 1.236025,
        "summary": {
          "error_count": 0,
          "warning_count": 0,
          "info_count": 0
        },
        "enhanced": true
      },
      "report": {
        "summary": {
          "error_count": 0,
          "warning_count": 0,
          "info_count": 0
        },
        "issues_by_type": {},
        "issues_by_severity": {
          "error": 0,
          "warning": 0,
          "info": 0
        },
        "recommendations": [],
        "priority_issues": []
      },
      "timestamp": "2025-09-28T15:44:47.439355"
    },
    "error": null,
    "completed_at": "2025-09-28T15:44:47.439355"
  },
  "task_191d54ca3aa6": {
    "task_id": "task_191d54ca3aa6",
    "status": "completed",
    "created_at": "2025-09-28T15:46:23.878938",
    "started_at": "2025-09-28T15:46:23.878938",
    "result": {
      "success": true,
      "task_id": "task_191d54ca3aa6",
      "detection_results": {
        "file_path": "uploads\\test_python.py",
        "language": "python",
        "total_issues": 32,
        "issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 5,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 8,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def function_without_docstring():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 15,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def long_function_with_many_params(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z):",
                "is_issue_line": false
              },
              {
                "line_number": 14,
                "content": "    # 参数过多",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    global API_KEY",
                "is_issue_line": true
              },
              {
                "line_number": 16,
                "content": "    return API_KEY",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "def function_with_bare_except():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 16,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 13,
                "content": "def long_function_with_many_params(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z):",
                "is_issue_line": false
              },
              {
                "line_number": 14,
                "content": "    # 参数过多",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    global API_KEY",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "    return API_KEY",
                "is_issue_line": true
              },
              {
                "line_number": 17,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "def function_with_bare_except():",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    try:",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 5,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 8,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def function_without_docstring():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: os",
            "line": 2,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# 测试Python代码",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": true
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: sys",
            "line": 3,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# 测试Python代码",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": true
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "global_variables",
            "severity": "warning",
            "message": "使用全局变量",
            "line": 15,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def long_function_with_many_params(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z):",
                "is_issue_line": false
              },
              {
                "line_number": 14,
                "content": "    # 参数过多",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    global API_KEY",
                "is_issue_line": true
              },
              {
                "line_number": 16,
                "content": "    return API_KEY",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "def function_with_bare_except():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "全局变量会增加代码的复杂性和测试难度。建议使用函数参数或类属性。",
            "fix_suggestions": [
              "使用函数参数传递数据",
              "使用类属性",
              "使用单例模式"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "global_variables",
            "severity": "warning",
            "message": "使用全局变量",
            "line": 15,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def long_function_with_many_params(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z):",
                "is_issue_line": false
              },
              {
                "line_number": 14,
                "content": "    # 参数过多",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    global API_KEY",
                "is_issue_line": true
              },
              {
                "line_number": 16,
                "content": "    return API_KEY",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "def function_with_bare_except():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "全局变量会增加代码的复杂性和测试难度。建议使用函数参数或类属性。",
            "fix_suggestions": [
              "使用函数参数传递数据",
              "使用类属性",
              "使用单例模式"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "too_many_parameters",
            "severity": "warning",
            "message": "函数参数过多 (26 个)",
            "line": 13,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 10,
                "content": "def function_without_docstring():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def long_function_with_many_params(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z):",
                "is_issue_line": true
              },
              {
                "line_number": 14,
                "content": "    # 参数过多",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    global API_KEY",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "    return API_KEY",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 7,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def function_without_docstring():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 13,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 10,
                "content": "def function_without_docstring():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def long_function_with_many_params(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z):",
                "is_issue_line": true
              },
              {
                "line_number": 14,
                "content": "    # 参数过多",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    global API_KEY",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "    return API_KEY",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 24,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 21,
                "content": "    except:  # 裸露的except",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "        pass",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 24,
                "content": "def risky_operation():",
                "is_issue_line": true
              },
              {
                "line_number": 25,
                "content": "    pass",
                "is_issue_line": false
              },
              {
                "line_number": 26,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 11",
            "line": 30,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "    unsafe_function(\"1+1\")",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    function_without_docstring()",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    long_function_with_many_params(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    function_with_bare_except()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 12",
            "line": 30,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "    unsafe_function(\"1+1\")",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    function_without_docstring()",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    long_function_with_many_params(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    function_with_bare_except()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 13",
            "line": 30,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "    unsafe_function(\"1+1\")",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    function_without_docstring()",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    long_function_with_many_params(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    function_with_bare_except()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 14",
            "line": 30,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "    unsafe_function(\"1+1\")",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    function_without_docstring()",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    long_function_with_many_params(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    function_with_bare_except()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 15",
            "line": 30,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "    unsafe_function(\"1+1\")",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    function_without_docstring()",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    long_function_with_many_params(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    function_with_bare_except()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 16",
            "line": 30,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "    unsafe_function(\"1+1\")",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    function_without_docstring()",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    long_function_with_many_params(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    function_with_bare_except()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 17",
            "line": 30,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "    unsafe_function(\"1+1\")",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    function_without_docstring()",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    long_function_with_many_params(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    function_with_bare_except()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 18",
            "line": 30,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "    unsafe_function(\"1+1\")",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    function_without_docstring()",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    long_function_with_many_params(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    function_with_bare_except()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 19",
            "line": 30,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "    unsafe_function(\"1+1\")",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    function_without_docstring()",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    long_function_with_many_params(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    function_with_bare_except()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 20",
            "line": 30,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "    unsafe_function(\"1+1\")",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    function_without_docstring()",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    long_function_with_many_params(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    function_with_bare_except()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 21",
            "line": 30,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "    unsafe_function(\"1+1\")",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    function_without_docstring()",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    long_function_with_many_params(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    function_with_bare_except()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 22",
            "line": 30,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "    unsafe_function(\"1+1\")",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    function_without_docstring()",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    long_function_with_many_params(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    function_with_bare_except()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 23",
            "line": 30,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "    unsafe_function(\"1+1\")",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    function_without_docstring()",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    long_function_with_many_params(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    function_with_bare_except()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 24",
            "line": 30,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "    unsafe_function(\"1+1\")",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    function_without_docstring()",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    long_function_with_many_params(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    function_with_bare_except()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 25",
            "line": 30,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "    unsafe_function(\"1+1\")",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    function_without_docstring()",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    long_function_with_many_params(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    function_with_bare_except()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 26",
            "line": 30,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "    unsafe_function(\"1+1\")",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    function_without_docstring()",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    long_function_with_many_params(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    function_with_bare_except()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "MEDIUM",
            "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
            "file": "test_python.py",
            "line": 8,
            "column": 0,
            "rule": "B307",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def function_without_docstring():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "LOW",
            "message": "Try, Except, Pass detected.",
            "file": "test_python.py",
            "line": 21,
            "column": 0,
            "rule": "B110",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 18,
                "content": "def function_with_bare_except():",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    try:",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "        risky_operation()",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "    except:  # 裸露的except",
                "is_issue_line": true
              },
              {
                "line_number": 22,
                "content": "        pass",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 24,
                "content": "def risky_operation():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          }
        ],
        "detection_tools": [
          "custom_analyzer",
          "bandit",
          "mypy"
        ],
        "analysis_time": 3.093082,
        "summary": {
          "error_count": 6,
          "warning_count": 5,
          "info_count": 19
        },
        "enhanced": true
      },
      "report": {
        "summary": {
          "error_count": 6,
          "warning_count": 5,
          "info_count": 19
        },
        "issues_by_type": {
          "hardcoded_secrets": 4,
          "unsafe_eval": 2,
          "unused_import": 2,
          "global_variables": 2,
          "too_many_parameters": 1,
          "missing_docstring": 3,
          "magic_number": 16,
          "bandit": 2
        },
        "issues_by_severity": {
          "error": 6,
          "warning": 5,
          "info": 19
        },
        "recommendations": [
          "发现严重错误，建议优先修复"
        ],
        "priority_issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 5,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 8,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def function_without_docstring():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    pass",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 15,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def long_function_with_many_params(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z):",
                "is_issue_line": false
              },
              {
                "line_number": 14,
                "content": "    # 参数过多",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    global API_KEY",
                "is_issue_line": true
              },
              {
                "line_number": 16,
                "content": "    return API_KEY",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "def function_with_bare_except():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 16,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 13,
                "content": "def long_function_with_many_params(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z):",
                "is_issue_line": false
              },
              {
                "line_number": 14,
                "content": "    # 参数过多",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    global API_KEY",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "    return API_KEY",
                "is_issue_line": true
              },
              {
                "line_number": 17,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "def function_with_bare_except():",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    try:",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 5,
            "file": "test_python.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "API_KEY = \"test_secret_123\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "def unsafe_function(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    return eval(user_input)  # 不安全的eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python.py",
            "enhanced": true
          }
        ]
      },
      "timestamp": "2025-09-28T15:46:26.981028"
    },
    "error": null,
    "completed_at": "2025-09-28T15:46:26.981028"
  },
  "task_87e956a75e85": {
    "task_id": "task_87e956a75e85",
    "status": "completed",
    "created_at": "2025-09-28T15:48:46.793937",
    "started_at": "2025-09-28T15:48:46.793937",
    "result": {
      "success": true,
      "task_id": "task_87e956a75e85",
      "detection_results": {
        "file_path": "uploads\\test_python.py",
        "language": "python",
        "total_issues": 0,
        "issues": [],
        "detection_tools": [
          "custom_analyzer",
          "pylint",
          "flake8",
          "bandit",
          "mypy"
        ],
        "analysis_time": 1.421499,
        "summary": {
          "error_count": 0,
          "warning_count": 0,
          "info_count": 0
        },
        "enhanced": true
      },
      "report": {
        "summary": {
          "error_count": 0,
          "warning_count": 0,
          "info_count": 0
        },
        "issues_by_type": {},
        "issues_by_severity": {
          "error": 0,
          "warning": 0,
          "info": 0
        },
        "recommendations": [],
        "priority_issues": []
      },
      "timestamp": "2025-09-28T15:48:48.242888"
    },
    "error": null,
    "completed_at": "2025-09-28T15:48:48.242888"
  },
  "task_cca22a00546f": {
    "task_id": "task_cca22a00546f",
    "status": "completed",
    "created_at": "2025-09-28T15:49:04.627836",
    "started_at": "2025-09-28T15:49:04.627836",
    "result": {
      "success": true,
      "task_id": "task_cca22a00546f",
      "detection_results": {
        "file_path": "uploads\\test_python_bad.py",
        "language": "python",
        "total_issues": 26,
        "issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 7,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 20,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 7,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的SECRET",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的PASSWORD",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 20,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "mypy",
            "severity": "error",
            "message": "Cannot find implementation or library stub for module named \"unused_module\"  [import-not-found]",
            "file": "test_python_bad.py",
            "line": 4,
            "column": 0,
            "rule": "mypy",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# test_python_bad.py - 有问题的Python代码示例",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": true
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: os",
            "line": 2,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# test_python_bad.py - 有问题的Python代码示例",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": true
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: sys",
            "line": 3,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# test_python_bad.py - 有问题的Python代码示例",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": true
              },
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: unused_module  # 未使用的导入",
            "line": 4,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# test_python_bad.py - 有问题的Python代码示例",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": true
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "global_variables",
            "severity": "warning",
            "message": "使用全局变量",
            "line": 38,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 35,
                "content": "global_var = \"I'm global\"",
                "is_issue_line": false
              },
              {
                "line_number": 36,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 37,
                "content": "def use_global():",
                "is_issue_line": false
              },
              {
                "line_number": 38,
                "content": "    global global_var",
                "is_issue_line": true
              },
              {
                "line_number": 39,
                "content": "    global_var = \"modified\"",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "全局变量会增加代码的复杂性和测试难度。建议使用函数参数或类属性。",
            "fix_suggestions": [
              "使用函数参数传递数据",
              "使用类属性",
              "使用单例模式"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "global_variables",
            "severity": "warning",
            "message": "使用全局变量",
            "line": 38,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 35,
                "content": "global_var = \"I'm global\"",
                "is_issue_line": false
              },
              {
                "line_number": 36,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 37,
                "content": "def use_global():",
                "is_issue_line": false
              },
              {
                "line_number": 38,
                "content": "    global global_var",
                "is_issue_line": true
              },
              {
                "line_number": 39,
                "content": "    global_var = \"modified\"",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "全局变量会增加代码的复杂性和测试难度。建议使用函数参数或类属性。",
            "fix_suggestions": [
              "使用函数参数传递数据",
              "使用类属性",
              "使用单例模式"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "文件操作未处理异常",
            "line": 45,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 42,
                "content": "# 不安全的文件操作",
                "is_issue_line": false
              },
              {
                "line_number": 43,
                "content": "def read_file(filename):",
                "is_issue_line": false
              },
              {
                "line_number": 44,
                "content": "    # 没有异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 45,
                "content": "    with open(filename, 'r') as f:",
                "is_issue_line": true
              },
              {
                "line_number": 46,
                "content": "        content = f.read()",
                "is_issue_line": false
              },
              {
                "line_number": 47,
                "content": "    return content",
                "is_issue_line": false
              },
              {
                "line_number": 48,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_type_conversion",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 19,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 16,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": true
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_type_conversion",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 57,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 54,
                "content": "    return big_list",
                "is_issue_line": false
              },
              {
                "line_number": 55,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 56,
                "content": "# 缺少主函数保护",
                "is_issue_line": false
              },
              {
                "line_number": 57,
                "content": "print(\"This will always execute\")",
                "is_issue_line": true
              },
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 10,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": true
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "    x = 1",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "    y = 2",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 23,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": true
              },
              {
                "line_number": 24,
                "content": "    # 缺少类型提示和文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 25,
                "content": "    # 缺少输入验证",
                "is_issue_line": false
              },
              {
                "line_number": 26,
                "content": "    processed = data * 2",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 37,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 34,
                "content": "# 全局变量（不好的实践）",
                "is_issue_line": false
              },
              {
                "line_number": 35,
                "content": "global_var = \"I'm global\"",
                "is_issue_line": false
              },
              {
                "line_number": 36,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 37,
                "content": "def use_global():",
                "is_issue_line": true
              },
              {
                "line_number": 38,
                "content": "    global global_var",
                "is_issue_line": false
              },
              {
                "line_number": 39,
                "content": "    global_var = \"modified\"",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 43,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 42,
                "content": "# 不安全的文件操作",
                "is_issue_line": false
              },
              {
                "line_number": 43,
                "content": "def read_file(filename):",
                "is_issue_line": true
              },
              {
                "line_number": 44,
                "content": "    # 没有异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 45,
                "content": "    with open(filename, 'r') as f:",
                "is_issue_line": false
              },
              {
                "line_number": 46,
                "content": "        content = f.read()",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 50,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 47,
                "content": "    return content",
                "is_issue_line": false
              },
              {
                "line_number": 48,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 49,
                "content": "# 内存泄漏风险",
                "is_issue_line": false
              },
              {
                "line_number": 50,
                "content": "def create_large_list():",
                "is_issue_line": true
              },
              {
                "line_number": 51,
                "content": "    big_list = []",
                "is_issue_line": false
              },
              {
                "line_number": 52,
                "content": "    for i in range(1000000):",
                "is_issue_line": false
              },
              {
                "line_number": 53,
                "content": "        big_list.append(f\"item_{i}\")",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 60,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 57,
                "content": "print(\"This will always execute\")",
                "is_issue_line": false
              },
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": true
              },
              {
                "line_number": 61,
                "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                "is_issue_line": false
              },
              {
                "line_number": 62,
                "content": "    return query",
                "is_issue_line": false
              },
              {
                "line_number": 63,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 1000000",
            "line": 52,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 49,
                "content": "# 内存泄漏风险",
                "is_issue_line": false
              },
              {
                "line_number": 50,
                "content": "def create_large_list():",
                "is_issue_line": false
              },
              {
                "line_number": 51,
                "content": "    big_list = []",
                "is_issue_line": false
              },
              {
                "line_number": 52,
                "content": "    for i in range(1000000):",
                "is_issue_line": true
              },
              {
                "line_number": 53,
                "content": "        big_list.append(f\"item_{i}\")",
                "is_issue_line": false
              },
              {
                "line_number": 54,
                "content": "    return big_list",
                "is_issue_line": false
              },
              {
                "line_number": 55,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "LOW",
            "message": "Possible hardcoded password: 'admin123'",
            "file": "test_python_bad.py",
            "line": 8,
            "column": 0,
            "rule": "B105",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "MEDIUM",
            "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
            "file": "test_python_bad.py",
            "line": 20,
            "column": 0,
            "rule": "B307",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "MEDIUM",
            "message": "Possible SQL injection vector through string-based query construction.",
            "file": "test_python_bad.py",
            "line": 61,
            "column": 0,
            "rule": "B608",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 61,
                "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                "is_issue_line": true
              },
              {
                "line_number": 62,
                "content": "    return query",
                "is_issue_line": false
              },
              {
                "line_number": 63,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 64,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          }
        ],
        "detection_tools": [
          "custom_analyzer",
          "bandit",
          "mypy"
        ],
        "analysis_time": 1.537592,
        "summary": {
          "error_count": 8,
          "warning_count": 8,
          "info_count": 7
        },
        "enhanced": true
      },
      "report": {
        "summary": {
          "error_count": 8,
          "warning_count": 8,
          "info_count": 7
        },
        "issues_by_type": {
          "hardcoded_secrets": 5,
          "unsafe_eval": 2,
          "mypy": 1,
          "unused_import": 3,
          "global_variables": 2,
          "unhandled_exception": 1,
          "unhandled_type_conversion": 2,
          "missing_docstring": 6,
          "magic_number": 1,
          "bandit": 3
        },
        "issues_by_severity": {
          "error": 8,
          "warning": 8,
          "info": 7
        },
        "recommendations": [
          "发现严重错误，建议优先修复"
        ],
        "priority_issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 7,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 20,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 7,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的SECRET",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          }
        ]
      },
      "timestamp": "2025-09-28T15:49:06.198304"
    },
    "error": null,
    "completed_at": "2025-09-28T15:49:06.198304"
  },
  "task_5c8be11b7c58": {
    "task_id": "task_5c8be11b7c58",
    "status": "completed",
    "created_at": "2025-09-28T15:50:02.581463",
    "started_at": "2025-09-28T15:50:02.581463",
    "result": {
      "success": true,
      "task_id": "task_5c8be11b7c58",
      "detection_results": {
        "success": true,
        "detection_results": {
          "project_path": "temp_extract\\project_20250928_155002",
          "total_files": 2,
          "total_issues": 28,
          "issues": [
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的密钥或密码",
              "line": 7,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的密钥或密码",
              "line": 8,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 20,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 17,
                  "content": "def risky_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "    user_input = \"print('Hello')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": true
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "def process_user_data(data):",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的API_KEY",
              "line": 7,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的SECRET",
              "line": 8,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的PASSWORD",
              "line": 8,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 20,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 17,
                  "content": "def risky_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "    user_input = \"print('Hello')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": true
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "def process_user_data(data):",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "mypy",
              "severity": "error",
              "message": "Cannot find implementation or library stub for module named \"unused_module\"  [import-not-found]",
              "file": "test_python_bad.py",
              "line": 4,
              "column": 0,
              "rule": "mypy",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "# test_python_bad.py - 有问题的Python代码示例",
                  "is_issue_line": false
                },
                {
                  "line_number": 2,
                  "content": "import os",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": true
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: os",
              "line": 2,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "# test_python_bad.py - 有问题的Python代码示例",
                  "is_issue_line": false
                },
                {
                  "line_number": 2,
                  "content": "import os",
                  "is_issue_line": true
                },
                {
                  "line_number": 3,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: sys",
              "line": 3,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "# test_python_bad.py - 有问题的Python代码示例",
                  "is_issue_line": false
                },
                {
                  "line_number": 2,
                  "content": "import os",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "import sys",
                  "is_issue_line": true
                },
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: unused_module  # 未使用的导入",
              "line": 4,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "# test_python_bad.py - 有问题的Python代码示例",
                  "is_issue_line": false
                },
                {
                  "line_number": 2,
                  "content": "import os",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": true
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "global_variables",
              "severity": "warning",
              "message": "使用全局变量",
              "line": 38,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 35,
                  "content": "global_var = \"I'm global\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 36,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 37,
                  "content": "def use_global():",
                  "is_issue_line": false
                },
                {
                  "line_number": 38,
                  "content": "    global global_var",
                  "is_issue_line": true
                },
                {
                  "line_number": 39,
                  "content": "    global_var = \"modified\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 40,
                  "content": "    return global_var",
                  "is_issue_line": false
                },
                {
                  "line_number": 41,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "全局变量会增加代码的复杂性和测试难度。建议使用函数参数或类属性。",
              "fix_suggestions": [
                "使用函数参数传递数据",
                "使用类属性",
                "使用单例模式"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "global_variables",
              "severity": "warning",
              "message": "使用全局变量",
              "line": 38,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 35,
                  "content": "global_var = \"I'm global\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 36,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 37,
                  "content": "def use_global():",
                  "is_issue_line": false
                },
                {
                  "line_number": 38,
                  "content": "    global global_var",
                  "is_issue_line": true
                },
                {
                  "line_number": 39,
                  "content": "    global_var = \"modified\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 40,
                  "content": "    return global_var",
                  "is_issue_line": false
                },
                {
                  "line_number": 41,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "全局变量会增加代码的复杂性和测试难度。建议使用函数参数或类属性。",
              "fix_suggestions": [
                "使用函数参数传递数据",
                "使用类属性",
                "使用单例模式"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unhandled_exception",
              "severity": "warning",
              "message": "文件操作未处理异常",
              "line": 45,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 42,
                  "content": "# 不安全的文件操作",
                  "is_issue_line": false
                },
                {
                  "line_number": 43,
                  "content": "def read_file(filename):",
                  "is_issue_line": false
                },
                {
                  "line_number": 44,
                  "content": "    # 没有异常处理",
                  "is_issue_line": false
                },
                {
                  "line_number": 45,
                  "content": "    with open(filename, 'r') as f:",
                  "is_issue_line": true
                },
                {
                  "line_number": 46,
                  "content": "        content = f.read()",
                  "is_issue_line": false
                },
                {
                  "line_number": 47,
                  "content": "    return content",
                  "is_issue_line": false
                },
                {
                  "line_number": 48,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unhandled_type_conversion",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 19,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 16,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "def risky_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "    user_input = \"print('Hello')\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unhandled_type_conversion",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 57,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 54,
                  "content": "    return big_list",
                  "is_issue_line": false
                },
                {
                  "line_number": 55,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 56,
                  "content": "# 缺少主函数保护",
                  "is_issue_line": false
                },
                {
                  "line_number": 57,
                  "content": "print(\"This will always execute\")",
                  "is_issue_line": true
                },
                {
                  "line_number": 58,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 59,
                  "content": "# 不安全的字符串格式化",
                  "is_issue_line": false
                },
                {
                  "line_number": 60,
                  "content": "def format_string(user_input):",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "memory_leak",
              "severity": "warning",
              "message": "可能存在内存泄漏",
              "line": 17,
              "file": "test_java.java",
              "language": "java",
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "        // 资源泄漏",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "        FileInputStream fis = null;",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "        try {",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "            fis = new FileInputStream(\"test.txt\");",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "            // 处理文件",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "        } catch (IOException e) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "            e.printStackTrace();",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_java.java",
              "enhanced": true
            },
            {
              "type": "memory_leak",
              "severity": "warning",
              "message": "可能存在内存泄漏",
              "line": 25,
              "file": "test_java.java",
              "language": "java",
              "code_snippet": [
                {
                  "line_number": 22,
                  "content": "        // 忘记关闭文件流",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "        ",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "        // 内存泄漏风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 25,
                  "content": "        List<String> list = new ArrayList<>();",
                  "is_issue_line": true
                },
                {
                  "line_number": 26,
                  "content": "        for (int i = 0; i < 1000000; i++) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 27,
                  "content": "            list.add(\"item\" + i);",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "        }",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_java.java",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 10,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 12,
                  "content": "    x = 1",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "    y = 2",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 23,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "def process_user_data(data):",
                  "is_issue_line": true
                },
                {
                  "line_number": 24,
                  "content": "    # 缺少类型提示和文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 25,
                  "content": "    # 缺少输入验证",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    processed = data * 2",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 37,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 34,
                  "content": "# 全局变量（不好的实践）",
                  "is_issue_line": false
                },
                {
                  "line_number": 35,
                  "content": "global_var = \"I'm global\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 36,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 37,
                  "content": "def use_global():",
                  "is_issue_line": true
                },
                {
                  "line_number": 38,
                  "content": "    global global_var",
                  "is_issue_line": false
                },
                {
                  "line_number": 39,
                  "content": "    global_var = \"modified\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 40,
                  "content": "    return global_var",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 43,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 40,
                  "content": "    return global_var",
                  "is_issue_line": false
                },
                {
                  "line_number": 41,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 42,
                  "content": "# 不安全的文件操作",
                  "is_issue_line": false
                },
                {
                  "line_number": 43,
                  "content": "def read_file(filename):",
                  "is_issue_line": true
                },
                {
                  "line_number": 44,
                  "content": "    # 没有异常处理",
                  "is_issue_line": false
                },
                {
                  "line_number": 45,
                  "content": "    with open(filename, 'r') as f:",
                  "is_issue_line": false
                },
                {
                  "line_number": 46,
                  "content": "        content = f.read()",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 50,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 47,
                  "content": "    return content",
                  "is_issue_line": false
                },
                {
                  "line_number": 48,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 49,
                  "content": "# 内存泄漏风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 50,
                  "content": "def create_large_list():",
                  "is_issue_line": true
                },
                {
                  "line_number": 51,
                  "content": "    big_list = []",
                  "is_issue_line": false
                },
                {
                  "line_number": 52,
                  "content": "    for i in range(1000000):",
                  "is_issue_line": false
                },
                {
                  "line_number": 53,
                  "content": "        big_list.append(f\"item_{i}\")",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 60,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 57,
                  "content": "print(\"This will always execute\")",
                  "is_issue_line": false
                },
                {
                  "line_number": 58,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 59,
                  "content": "# 不安全的字符串格式化",
                  "is_issue_line": false
                },
                {
                  "line_number": 60,
                  "content": "def format_string(user_input):",
                  "is_issue_line": true
                },
                {
                  "line_number": 61,
                  "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 62,
                  "content": "    return query",
                  "is_issue_line": false
                },
                {
                  "line_number": 63,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "magic_number",
              "severity": "info",
              "message": "魔法数字: 1000000",
              "line": 52,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 49,
                  "content": "# 内存泄漏风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 50,
                  "content": "def create_large_list():",
                  "is_issue_line": false
                },
                {
                  "line_number": 51,
                  "content": "    big_list = []",
                  "is_issue_line": false
                },
                {
                  "line_number": 52,
                  "content": "    for i in range(1000000):",
                  "is_issue_line": true
                },
                {
                  "line_number": 53,
                  "content": "        big_list.append(f\"item_{i}\")",
                  "is_issue_line": false
                },
                {
                  "line_number": 54,
                  "content": "    return big_list",
                  "is_issue_line": false
                },
                {
                  "line_number": 55,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "LOW",
              "message": "Possible hardcoded password: 'admin123'",
              "file": "test_python_bad.py",
              "line": 8,
              "column": 0,
              "rule": "B105",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "MEDIUM",
              "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
              "file": "test_python_bad.py",
              "line": 20,
              "column": 0,
              "rule": "B307",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 17,
                  "content": "def risky_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "    user_input = \"print('Hello')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": true
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "def process_user_data(data):",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "MEDIUM",
              "message": "Possible SQL injection vector through string-based query construction.",
              "file": "test_python_bad.py",
              "line": 61,
              "column": 0,
              "rule": "B608",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 58,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 59,
                  "content": "# 不安全的字符串格式化",
                  "is_issue_line": false
                },
                {
                  "line_number": 60,
                  "content": "def format_string(user_input):",
                  "is_issue_line": false
                },
                {
                  "line_number": 61,
                  "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                  "is_issue_line": true
                },
                {
                  "line_number": 62,
                  "content": "    return query",
                  "is_issue_line": false
                },
                {
                  "line_number": 63,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 64,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_155002\\test_zip\\test_python_bad.py",
              "enhanced": true
            }
          ],
          "detection_tools": [
            "ai_analyzer",
            "mypy",
            "bandit",
            "custom_analyzer"
          ],
          "analysis_time": 24.273198999999998,
          "summary": {
            "error_count": 8,
            "warning_count": 10,
            "info_count": 7
          },
          "languages_detected": [
            "python",
            "java"
          ]
        }
      },
      "report": {
        "summary": {},
        "issues_by_type": {},
        "issues_by_severity": {
          "error": 0,
          "warning": 0,
          "info": 0
        },
        "recommendations": [],
        "priority_issues": []
      },
      "timestamp": "2025-09-28T15:50:26.929664"
    },
    "error": null,
    "completed_at": "2025-09-28T15:50:26.929664"
  },
  "task_faa4cea978e9": {
    "task_id": "task_faa4cea978e9",
    "status": "completed",
    "created_at": "2025-09-28T15:50:57.185607",
    "started_at": "2025-09-28T15:50:57.185607",
    "result": {
      "success": true,
      "task_id": "task_faa4cea978e9",
      "detection_results": {
        "success": true,
        "detection_results": {
          "project_path": "temp_extract\\project_20250928_155057",
          "total_files": 4,
          "total_issues": 20,
          "issues": [
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的密钥或密码",
              "line": 10,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 7,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的密钥或密码",
              "line": 11,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 17,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "def missing_docstring_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的API_KEY",
              "line": 10,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 7,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的SECRET",
              "line": 11,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的PASSWORD",
              "line": 11,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 17,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "def missing_docstring_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "mypy",
              "severity": "error",
              "message": "Cannot find implementation or library stub for module named \"unused_module\"  [import-not-found]",
              "file": "test_python_with_issues.py",
              "line": 26,
              "column": 0,
              "rule": "mypy",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 23,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "def unused_import_test():",
                  "is_issue_line": false
                },
                {
                  "line_number": 25,
                  "content": "    # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    import unused_module",
                  "is_issue_line": true
                },
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def main():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "null_pointer_dereference",
              "severity": "error",
              "message": "潜在的空指针解引用",
              "line": 6,
              "file": "test_java_with_issues.java",
              "language": "java",
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "    public static void main(String[] args) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "        // 空指针解引用风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "        String str = null;",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "        if (str == null) {",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "            System.out.println(\"String is null\");",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "        }",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "        ",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_java_with_issues.java",
              "enhanced": true
            },
            {
              "type": "buffer_overflow",
              "severity": "error",
              "message": "缓冲区溢出风险",
              "line": 8,
              "file": "test_c_with_issues.c",
              "language": "c",
              "code_snippet": [
                {
                  "line_number": 5,
                  "content": "int main() {",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    // 缓冲区溢出风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "    char buffer[10];",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "    strcpy(buffer, \"This is a very long string that will cause buffer overflow\");",
                  "is_issue_line": true
                },
                {
                  "line_number": 9,
                  "content": "    ",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "    // 内存泄漏",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "    char* ptr = malloc(100);",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_c_with_issues.c",
              "enhanced": true
            },
            {
              "type": "xss_vulnerability",
              "severity": "error",
              "message": "XSS漏洞风险",
              "line": 5,
              "file": "test_js_with_issues.js",
              "language": "javascript",
              "code_snippet": [
                {
                  "line_number": 2,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "// XSS漏洞风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "function displayUserInput(userInput) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "    document.getElementById('output').innerHTML = userInput;",
                  "is_issue_line": true
                },
                {
                  "line_number": 6,
                  "content": "    document.write(userInput);",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "}",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_js_with_issues.js",
              "enhanced": true
            },
            {
              "type": "xss_vulnerability",
              "severity": "error",
              "message": "XSS漏洞风险",
              "line": 6,
              "file": "test_js_with_issues.js",
              "language": "javascript",
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "// XSS漏洞风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "function displayUserInput(userInput) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "    document.getElementById('output').innerHTML = userInput;",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    document.write(userInput);",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "}",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "// 未使用的变量",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_js_with_issues.js",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: os",
              "line": 6,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "测试文件 - 包含各种缺陷",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "import os",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: sys",
              "line": 7,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 4,
                  "content": "\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "import os",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "import sys",
                  "is_issue_line": true
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: unused_module",
              "line": 26,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 23,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "def unused_import_test():",
                  "is_issue_line": false
                },
                {
                  "line_number": 25,
                  "content": "    # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    import unused_module",
                  "is_issue_line": true
                },
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def main():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unhandled_type_conversion",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 16,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unhandled_type_conversion",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 30,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def main():",
                  "is_issue_line": false
                },
                {
                  "line_number": 30,
                  "content": "    print(\"测试文件运行中...\")",
                  "is_issue_line": true
                },
                {
                  "line_number": 31,
                  "content": "    unsafe_function()",
                  "is_issue_line": false
                },
                {
                  "line_number": 32,
                  "content": "    missing_docstring_function()",
                  "is_issue_line": false
                },
                {
                  "line_number": 33,
                  "content": "    unused_import_test()",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 24,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 21,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "def unused_import_test():",
                  "is_issue_line": true
                },
                {
                  "line_number": 25,
                  "content": "    # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    import unused_module",
                  "is_issue_line": false
                },
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_155057\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "LOW",
              "message": "Possible hardcoded password: 'admin123'",
              "file": "test_python_with_issues.py",
              "line": 11,
              "column": 0,
              "rule": "B105",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_155057\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "MEDIUM",
              "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
              "file": "test_python_with_issues.py",
              "line": 17,
              "column": 0,
              "rule": "B307",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "def missing_docstring_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_155057\\test_python_with_issues.py",
              "enhanced": true
            }
          ],
          "detection_tools": [
            "mypy",
            "bandit",
            "custom_analyzer",
            "ai_analyzer"
          ],
          "analysis_time": 60.89930699999999,
          "summary": {
            "error_count": 12,
            "warning_count": 5,
            "info_count": 1
          },
          "languages_detected": [
            "java",
            "javascript",
            "c",
            "python"
          ]
        }
      },
      "report": {
        "summary": {},
        "issues_by_type": {},
        "issues_by_severity": {
          "error": 0,
          "warning": 0,
          "info": 0
        },
        "recommendations": [],
        "priority_issues": []
      },
      "timestamp": "2025-09-28T15:51:58.164151"
    },
    "error": null,
    "completed_at": "2025-09-28T15:51:58.164151"
  },
  "task_d759314409c1": {
    "task_id": "task_d759314409c1",
    "status": "completed",
    "created_at": "2025-09-28T15:52:32.154360",
    "started_at": "2025-09-28T15:52:32.154360",
    "result": {
      "success": true,
      "task_id": "task_d759314409c1",
      "detection_results": {
        "success": true,
        "detection_results": {
          "project_path": "temp_extract\\project_20250928_155232",
          "total_files": 4,
          "total_issues": 20,
          "issues": [
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的密钥或密码",
              "line": 10,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 7,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的密钥或密码",
              "line": 11,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 17,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "def missing_docstring_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的API_KEY",
              "line": 10,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 7,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的SECRET",
              "line": 11,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的PASSWORD",
              "line": 11,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 17,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "def missing_docstring_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "mypy",
              "severity": "error",
              "message": "Cannot find implementation or library stub for module named \"unused_module\"  [import-not-found]",
              "file": "test_python_with_issues.py",
              "line": 26,
              "column": 0,
              "rule": "mypy",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 23,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "def unused_import_test():",
                  "is_issue_line": false
                },
                {
                  "line_number": 25,
                  "content": "    # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    import unused_module",
                  "is_issue_line": true
                },
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def main():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "null_pointer_dereference",
              "severity": "error",
              "message": "潜在的空指针解引用",
              "line": 6,
              "file": "test_java_with_issues.java",
              "language": "java",
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "    public static void main(String[] args) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "        // 空指针解引用风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "        String str = null;",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "        if (str == null) {",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "            System.out.println(\"String is null\");",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "        }",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "        ",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_java_with_issues.java",
              "enhanced": true
            },
            {
              "type": "buffer_overflow",
              "severity": "error",
              "message": "缓冲区溢出风险",
              "line": 8,
              "file": "test_c_with_issues.c",
              "language": "c",
              "code_snippet": [
                {
                  "line_number": 5,
                  "content": "int main() {",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    // 缓冲区溢出风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "    char buffer[10];",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "    strcpy(buffer, \"This is a very long string that will cause buffer overflow\");",
                  "is_issue_line": true
                },
                {
                  "line_number": 9,
                  "content": "    ",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "    // 内存泄漏",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "    char* ptr = malloc(100);",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_c_with_issues.c",
              "enhanced": true
            },
            {
              "type": "xss_vulnerability",
              "severity": "error",
              "message": "XSS漏洞风险",
              "line": 5,
              "file": "test_js_with_issues.js",
              "language": "javascript",
              "code_snippet": [
                {
                  "line_number": 2,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "// XSS漏洞风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "function displayUserInput(userInput) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "    document.getElementById('output').innerHTML = userInput;",
                  "is_issue_line": true
                },
                {
                  "line_number": 6,
                  "content": "    document.write(userInput);",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "}",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_js_with_issues.js",
              "enhanced": true
            },
            {
              "type": "xss_vulnerability",
              "severity": "error",
              "message": "XSS漏洞风险",
              "line": 6,
              "file": "test_js_with_issues.js",
              "language": "javascript",
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "// XSS漏洞风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "function displayUserInput(userInput) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "    document.getElementById('output').innerHTML = userInput;",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    document.write(userInput);",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "}",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "// 未使用的变量",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_js_with_issues.js",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: os",
              "line": 6,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "测试文件 - 包含各种缺陷",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "import os",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: sys",
              "line": 7,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 4,
                  "content": "\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "import os",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "import sys",
                  "is_issue_line": true
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: unused_module",
              "line": 26,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 23,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "def unused_import_test():",
                  "is_issue_line": false
                },
                {
                  "line_number": 25,
                  "content": "    # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    import unused_module",
                  "is_issue_line": true
                },
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def main():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unhandled_type_conversion",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 16,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unhandled_type_conversion",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 30,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def main():",
                  "is_issue_line": false
                },
                {
                  "line_number": 30,
                  "content": "    print(\"测试文件运行中...\")",
                  "is_issue_line": true
                },
                {
                  "line_number": 31,
                  "content": "    unsafe_function()",
                  "is_issue_line": false
                },
                {
                  "line_number": 32,
                  "content": "    missing_docstring_function()",
                  "is_issue_line": false
                },
                {
                  "line_number": 33,
                  "content": "    unused_import_test()",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 24,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 21,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "def unused_import_test():",
                  "is_issue_line": true
                },
                {
                  "line_number": 25,
                  "content": "    # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    import unused_module",
                  "is_issue_line": false
                },
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_155232\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "LOW",
              "message": "Possible hardcoded password: 'admin123'",
              "file": "test_python_with_issues.py",
              "line": 11,
              "column": 0,
              "rule": "B105",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_155232\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "MEDIUM",
              "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
              "file": "test_python_with_issues.py",
              "line": 17,
              "column": 0,
              "rule": "B307",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "def missing_docstring_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_155232\\test_python_with_issues.py",
              "enhanced": true
            }
          ],
          "detection_tools": [
            "ai_analyzer",
            "custom_analyzer",
            "bandit",
            "mypy"
          ],
          "analysis_time": 66.487363,
          "summary": {
            "error_count": 12,
            "warning_count": 5,
            "info_count": 1
          },
          "languages_detected": [
            "c",
            "javascript",
            "java",
            "python"
          ]
        }
      },
      "report": {
        "summary": {},
        "issues_by_type": {},
        "issues_by_severity": {
          "error": 0,
          "warning": 0,
          "info": 0
        },
        "recommendations": [],
        "priority_issues": []
      },
      "timestamp": "2025-09-28T15:53:38.759104"
    },
    "error": null,
    "completed_at": "2025-09-28T15:53:38.759104"
  },
  "task_c9a08df68433": {
    "task_id": "task_c9a08df68433",
    "status": "completed",
    "created_at": "2025-09-28T15:58:24.594336",
    "started_at": "2025-09-28T15:58:24.594336",
    "result": {
      "success": true,
      "task_id": "task_c9a08df68433",
      "detection_results": {
        "file_path": "uploads\\test_python.py",
        "language": "python",
        "total_issues": 1,
        "issues": [
          {
            "type": "syntax_error",
            "severity": "error",
            "message": "语法错误: source code string cannot contain null bytes",
            "line": 1,
            "file": "test_python.py",
            "language": "python",
            "column": 0
          }
        ],
        "detection_tools": [
          "custom_analyzer",
          "bandit",
          "mypy"
        ],
        "analysis_time": 0.893386,
        "summary": {
          "error_count": 1,
          "warning_count": 0,
          "info_count": 0
        }
      },
      "report": {
        "summary": {
          "error_count": 1,
          "warning_count": 0,
          "info_count": 0
        },
        "issues_by_type": {
          "syntax_error": 1
        },
        "issues_by_severity": {
          "error": 1,
          "warning": 0,
          "info": 0
        },
        "recommendations": [
          "发现严重错误，建议优先修复"
        ],
        "priority_issues": [
          {
            "type": "syntax_error",
            "severity": "error",
            "message": "语法错误: source code string cannot contain null bytes",
            "line": 1,
            "file": "test_python.py",
            "language": "python",
            "column": 0
          }
        ]
      },
      "timestamp": "2025-09-28T15:58:25.561807"
    },
    "error": null,
    "completed_at": "2025-09-28T15:58:25.561807"
  },
  "task_257614270284": {
    "task_id": "task_257614270284",
    "status": "completed",
    "created_at": "2025-09-28T15:58:54.632457",
    "started_at": "2025-09-28T15:58:54.632457",
    "result": {
      "success": true,
      "task_id": "task_257614270284",
      "detection_results": {
        "success": true,
        "detection_results": {
          "project_path": "temp_extract\\project_20250928_155854",
          "total_files": 4,
          "total_issues": 27,
          "issues": [
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的密钥或密码",
              "line": 10,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 7,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的密钥或密码",
              "line": 11,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 17,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "def missing_docstring_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的API_KEY",
              "line": 10,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 7,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的SECRET",
              "line": 11,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的PASSWORD",
              "line": 11,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 17,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "def missing_docstring_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "mypy",
              "severity": "error",
              "message": "Cannot find implementation or library stub for module named \"unused_module\"  [import-not-found]",
              "file": "test_python_with_issues.py",
              "line": 26,
              "column": 0,
              "rule": "mypy",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 23,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "def unused_import_test():",
                  "is_issue_line": false
                },
                {
                  "line_number": 25,
                  "content": "    # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    import unused_module",
                  "is_issue_line": true
                },
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def main():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "null_pointer_dereference",
              "severity": "error",
              "message": "潜在的空指针解引用",
              "line": 6,
              "file": "test_java_with_issues.java",
              "language": "java",
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "    public static void main(String[] args) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "        // 空指针解引用风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "        String str = null;",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "        if (str == null) {",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "            System.out.println(\"String is null\");",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "        }",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "        ",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_java_with_issues.java",
              "enhanced": true
            },
            {
              "type": "buffer_overflow",
              "severity": "error",
              "message": "缓冲区溢出风险",
              "line": 8,
              "file": "test_c_with_issues.c",
              "language": "c",
              "code_snippet": [
                {
                  "line_number": 5,
                  "content": "int main() {",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    // 缓冲区溢出风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "    char buffer[10];",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "    strcpy(buffer, \"This is a very long string that will cause buffer overflow\");",
                  "is_issue_line": true
                },
                {
                  "line_number": 9,
                  "content": "    ",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "    // 内存泄漏",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "    char* ptr = malloc(100);",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_c_with_issues.c",
              "enhanced": true
            },
            {
              "type": "xss_vulnerability",
              "severity": "error",
              "message": "XSS漏洞风险",
              "line": 5,
              "file": "test_js_with_issues.js",
              "language": "javascript",
              "code_snippet": [
                {
                  "line_number": 2,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "// XSS漏洞风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "function displayUserInput(userInput) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "    document.getElementById('output').innerHTML = userInput;",
                  "is_issue_line": true
                },
                {
                  "line_number": 6,
                  "content": "    document.write(userInput);",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "}",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_js_with_issues.js",
              "enhanced": true
            },
            {
              "type": "xss_vulnerability",
              "severity": "error",
              "message": "XSS漏洞风险",
              "line": 6,
              "file": "test_js_with_issues.js",
              "language": "javascript",
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "// XSS漏洞风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "function displayUserInput(userInput) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "    document.getElementById('output').innerHTML = userInput;",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    document.write(userInput);",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "}",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "// 未使用的变量",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_js_with_issues.js",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: os",
              "line": 6,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "测试文件 - 包含各种缺陷",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "import os",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: sys",
              "line": 7,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 4,
                  "content": "\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "import os",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "import sys",
                  "is_issue_line": true
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: unused_module",
              "line": 26,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 23,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "def unused_import_test():",
                  "is_issue_line": false
                },
                {
                  "line_number": 25,
                  "content": "    # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    import unused_module",
                  "is_issue_line": true
                },
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def main():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "division_by_zero_risk",
              "severity": "warning",
              "message": "可能存在除零风险",
              "line": 1,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "#!/usr/bin/env python3",
                  "is_issue_line": true
                },
                {
                  "line_number": 2,
                  "content": "\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "测试文件 - 包含各种缺陷",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unhandled_exception",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 16,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unhandled_exception",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 30,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def main():",
                  "is_issue_line": false
                },
                {
                  "line_number": 30,
                  "content": "    print(\"测试文件运行中...\")",
                  "is_issue_line": true
                },
                {
                  "line_number": 31,
                  "content": "    unsafe_function()",
                  "is_issue_line": false
                },
                {
                  "line_number": 32,
                  "content": "    missing_docstring_function()",
                  "is_issue_line": false
                },
                {
                  "line_number": 33,
                  "content": "    unused_import_test()",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unhandled_type_conversion",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 16,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unhandled_type_conversion",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 30,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def main():",
                  "is_issue_line": false
                },
                {
                  "line_number": 30,
                  "content": "    print(\"测试文件运行中...\")",
                  "is_issue_line": true
                },
                {
                  "line_number": 31,
                  "content": "    unsafe_function()",
                  "is_issue_line": false
                },
                {
                  "line_number": 32,
                  "content": "    missing_docstring_function()",
                  "is_issue_line": false
                },
                {
                  "line_number": 33,
                  "content": "    unused_import_test()",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 unsafe_function 缺少参数验证",
              "line": 13,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 missing_docstring_function 缺少参数验证",
              "line": 20,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "def missing_docstring_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 21,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 unused_import_test 缺少参数验证",
              "line": 24,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 21,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "def unused_import_test():",
                  "is_issue_line": true
                },
                {
                  "line_number": 25,
                  "content": "    # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    import unused_module",
                  "is_issue_line": false
                },
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 main 缺少参数验证",
              "line": 29,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 26,
                  "content": "    import unused_module",
                  "is_issue_line": false
                },
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def main():",
                  "is_issue_line": true
                },
                {
                  "line_number": 30,
                  "content": "    print(\"测试文件运行中...\")",
                  "is_issue_line": false
                },
                {
                  "line_number": 31,
                  "content": "    unsafe_function()",
                  "is_issue_line": false
                },
                {
                  "line_number": 32,
                  "content": "    missing_docstring_function()",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 24,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 21,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "def unused_import_test():",
                  "is_issue_line": true
                },
                {
                  "line_number": 25,
                  "content": "    # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    import unused_module",
                  "is_issue_line": false
                },
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "LOW",
              "message": "Possible hardcoded password: 'admin123'",
              "file": "test_python_with_issues.py",
              "line": 11,
              "column": 0,
              "rule": "B105",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "MEDIUM",
              "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
              "file": "test_python_with_issues.py",
              "line": 17,
              "column": 0,
              "rule": "B307",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "def missing_docstring_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_155854\\test_python_with_issues.py",
              "enhanced": true
            }
          ],
          "detection_tools": [
            "ai_analyzer",
            "custom_analyzer",
            "bandit",
            "mypy"
          ],
          "analysis_time": 88.503653,
          "summary": {
            "error_count": 12,
            "warning_count": 8,
            "info_count": 5
          },
          "languages_detected": [
            "javascript",
            "c",
            "python",
            "java"
          ]
        }
      },
      "report": {
        "summary": {},
        "issues_by_type": {},
        "issues_by_severity": {
          "error": 0,
          "warning": 0,
          "info": 0
        },
        "recommendations": [],
        "priority_issues": []
      },
      "timestamp": "2025-09-28T16:00:23.280459"
    },
    "error": null,
    "completed_at": "2025-09-28T16:00:23.280459"
  },
  "task_84dd8d77e589": {
    "task_id": "task_84dd8d77e589",
    "status": "completed",
    "created_at": "2025-09-28T16:00:51.685293",
    "started_at": "2025-09-28T16:00:51.685293",
    "result": {
      "success": true,
      "task_id": "task_84dd8d77e589",
      "detection_results": {
        "success": true,
        "detection_results": {
          "project_path": "temp_extract\\project_20250928_160051",
          "total_files": 4,
          "total_issues": 27,
          "issues": [
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的密钥或密码",
              "line": 10,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 7,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的密钥或密码",
              "line": 11,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 17,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "def missing_docstring_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的API_KEY",
              "line": 10,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 7,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的SECRET",
              "line": 11,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的PASSWORD",
              "line": 11,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 17,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "def missing_docstring_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "mypy",
              "severity": "error",
              "message": "Cannot find implementation or library stub for module named \"unused_module\"  [import-not-found]",
              "file": "test_python_with_issues.py",
              "line": 26,
              "column": 0,
              "rule": "mypy",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 23,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "def unused_import_test():",
                  "is_issue_line": false
                },
                {
                  "line_number": 25,
                  "content": "    # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    import unused_module",
                  "is_issue_line": true
                },
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def main():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "null_pointer_dereference",
              "severity": "error",
              "message": "潜在的空指针解引用",
              "line": 6,
              "file": "test_java_with_issues.java",
              "language": "java",
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "    public static void main(String[] args) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "        // 空指针解引用风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "        String str = null;",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "        if (str == null) {",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "            System.out.println(\"String is null\");",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "        }",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "        ",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_java_with_issues.java",
              "enhanced": true
            },
            {
              "type": "buffer_overflow",
              "severity": "error",
              "message": "缓冲区溢出风险",
              "line": 8,
              "file": "test_c_with_issues.c",
              "language": "c",
              "code_snippet": [
                {
                  "line_number": 5,
                  "content": "int main() {",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    // 缓冲区溢出风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "    char buffer[10];",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "    strcpy(buffer, \"This is a very long string that will cause buffer overflow\");",
                  "is_issue_line": true
                },
                {
                  "line_number": 9,
                  "content": "    ",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "    // 内存泄漏",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "    char* ptr = malloc(100);",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_c_with_issues.c",
              "enhanced": true
            },
            {
              "type": "xss_vulnerability",
              "severity": "error",
              "message": "XSS漏洞风险",
              "line": 5,
              "file": "test_js_with_issues.js",
              "language": "javascript",
              "code_snippet": [
                {
                  "line_number": 2,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "// XSS漏洞风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "function displayUserInput(userInput) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "    document.getElementById('output').innerHTML = userInput;",
                  "is_issue_line": true
                },
                {
                  "line_number": 6,
                  "content": "    document.write(userInput);",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "}",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_js_with_issues.js",
              "enhanced": true
            },
            {
              "type": "xss_vulnerability",
              "severity": "error",
              "message": "XSS漏洞风险",
              "line": 6,
              "file": "test_js_with_issues.js",
              "language": "javascript",
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "// XSS漏洞风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "function displayUserInput(userInput) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "    document.getElementById('output').innerHTML = userInput;",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    document.write(userInput);",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "}",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "// 未使用的变量",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_js_with_issues.js",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: os",
              "line": 6,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "测试文件 - 包含各种缺陷",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "import os",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: sys",
              "line": 7,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 4,
                  "content": "\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "import os",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "import sys",
                  "is_issue_line": true
                },
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: unused_module",
              "line": 26,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 23,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "def unused_import_test():",
                  "is_issue_line": false
                },
                {
                  "line_number": 25,
                  "content": "    # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    import unused_module",
                  "is_issue_line": true
                },
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def main():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "division_by_zero_risk",
              "severity": "warning",
              "message": "可能存在除零风险",
              "line": 1,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "#!/usr/bin/env python3",
                  "is_issue_line": true
                },
                {
                  "line_number": 2,
                  "content": "\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "测试文件 - 包含各种缺陷",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unhandled_exception",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 16,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unhandled_exception",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 30,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def main():",
                  "is_issue_line": false
                },
                {
                  "line_number": 30,
                  "content": "    print(\"测试文件运行中...\")",
                  "is_issue_line": true
                },
                {
                  "line_number": 31,
                  "content": "    unsafe_function()",
                  "is_issue_line": false
                },
                {
                  "line_number": 32,
                  "content": "    missing_docstring_function()",
                  "is_issue_line": false
                },
                {
                  "line_number": 33,
                  "content": "    unused_import_test()",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unhandled_type_conversion",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 16,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "unhandled_type_conversion",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 30,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def main():",
                  "is_issue_line": false
                },
                {
                  "line_number": 30,
                  "content": "    print(\"测试文件运行中...\")",
                  "is_issue_line": true
                },
                {
                  "line_number": 31,
                  "content": "    unsafe_function()",
                  "is_issue_line": false
                },
                {
                  "line_number": 32,
                  "content": "    missing_docstring_function()",
                  "is_issue_line": false
                },
                {
                  "line_number": 33,
                  "content": "    unused_import_test()",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 unsafe_function 缺少参数验证",
              "line": 13,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 missing_docstring_function 缺少参数验证",
              "line": 20,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "def missing_docstring_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 21,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 unused_import_test 缺少参数验证",
              "line": 24,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 21,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "def unused_import_test():",
                  "is_issue_line": true
                },
                {
                  "line_number": 25,
                  "content": "    # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    import unused_module",
                  "is_issue_line": false
                },
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 main 缺少参数验证",
              "line": 29,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 26,
                  "content": "    import unused_module",
                  "is_issue_line": false
                },
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def main():",
                  "is_issue_line": true
                },
                {
                  "line_number": 30,
                  "content": "    print(\"测试文件运行中...\")",
                  "is_issue_line": false
                },
                {
                  "line_number": 31,
                  "content": "    unsafe_function()",
                  "is_issue_line": false
                },
                {
                  "line_number": 32,
                  "content": "    missing_docstring_function()",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 24,
              "file": "test_python_with_issues.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 21,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "def unused_import_test():",
                  "is_issue_line": true
                },
                {
                  "line_number": 25,
                  "content": "    # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    import unused_module",
                  "is_issue_line": false
                },
                {
                  "line_number": 27,
                  "content": "    return \"test\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "LOW",
              "message": "Possible hardcoded password: 'admin123'",
              "file": "test_python_with_issues.py",
              "line": 11,
              "column": 0,
              "rule": "B105",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 8,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "# 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 12,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "def unsafe_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "MEDIUM",
              "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
              "file": "test_python_with_issues.py",
              "line": 17,
              "column": 0,
              "rule": "B307",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "    \"\"\"不安全的函数\"\"\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "    user_input = \"print('Hello World')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "    result = eval(user_input)",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "def missing_docstring_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_160051\\test_python_with_issues.py",
              "enhanced": true
            }
          ],
          "detection_tools": [
            "custom_analyzer",
            "bandit",
            "ai_analyzer",
            "mypy"
          ],
          "analysis_time": 93.484407,
          "summary": {
            "error_count": 12,
            "warning_count": 8,
            "info_count": 5
          },
          "languages_detected": [
            "c",
            "java",
            "python",
            "javascript"
          ]
        }
      },
      "report": {
        "summary": {},
        "issues_by_type": {},
        "issues_by_severity": {
          "error": 0,
          "warning": 0,
          "info": 0
        },
        "recommendations": [],
        "priority_issues": []
      },
      "timestamp": "2025-09-28T16:02:25.279406"
    },
    "error": null,
    "completed_at": "2025-09-28T16:02:25.279406"
  },
  "task_af196759bec8": {
    "task_id": "task_af196759bec8",
    "status": "completed",
    "created_at": "2025-09-28T16:02:27.594104",
    "started_at": "2025-09-28T16:02:27.594104",
    "result": {
      "success": true,
      "task_id": "task_af196759bec8",
      "detection_results": {
        "success": true,
        "detection_results": {
          "project_path": "temp_extract\\project_20250928_160227",
          "total_files": 2,
          "total_issues": 39,
          "issues": [
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的密钥或密码",
              "line": 7,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的密钥或密码",
              "line": 8,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 20,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 17,
                  "content": "def risky_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "    user_input = \"print('Hello')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": true
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "def process_user_data(data):",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的API_KEY",
              "line": 7,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的SECRET",
              "line": 8,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的PASSWORD",
              "line": 8,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 20,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 17,
                  "content": "def risky_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "    user_input = \"print('Hello')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": true
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "def process_user_data(data):",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "mypy",
              "severity": "error",
              "message": "Cannot find implementation or library stub for module named \"unused_module\"  [import-not-found]",
              "file": "test_python_bad.py",
              "line": 4,
              "column": 0,
              "rule": "mypy",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "# test_python_bad.py - 有问题的Python代码示例",
                  "is_issue_line": false
                },
                {
                  "line_number": 2,
                  "content": "import os",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": true
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: os",
              "line": 2,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "# test_python_bad.py - 有问题的Python代码示例",
                  "is_issue_line": false
                },
                {
                  "line_number": 2,
                  "content": "import os",
                  "is_issue_line": true
                },
                {
                  "line_number": 3,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: sys",
              "line": 3,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "# test_python_bad.py - 有问题的Python代码示例",
                  "is_issue_line": false
                },
                {
                  "line_number": 2,
                  "content": "import os",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "import sys",
                  "is_issue_line": true
                },
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: unused_module  # 未使用的导入",
              "line": 4,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "# test_python_bad.py - 有问题的Python代码示例",
                  "is_issue_line": false
                },
                {
                  "line_number": 2,
                  "content": "import os",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": true
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unhandled_exception",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 19,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 16,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "def risky_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "    user_input = \"print('Hello')\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "division_by_zero_risk",
              "severity": "warning",
              "message": "可能存在除零风险",
              "line": 31,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def divide_numbers(a, b):",
                  "is_issue_line": false
                },
                {
                  "line_number": 30,
                  "content": "    # 缺少异常处理",
                  "is_issue_line": false
                },
                {
                  "line_number": 31,
                  "content": "    result = a / b  # 可能除零错误",
                  "is_issue_line": true
                },
                {
                  "line_number": 32,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 33,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 34,
                  "content": "# 全局变量（不好的实践）",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "global_variables",
              "severity": "warning",
              "message": "使用全局变量",
              "line": 38,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 35,
                  "content": "global_var = \"I'm global\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 36,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 37,
                  "content": "def use_global():",
                  "is_issue_line": false
                },
                {
                  "line_number": 38,
                  "content": "    global global_var",
                  "is_issue_line": true
                },
                {
                  "line_number": 39,
                  "content": "    global_var = \"modified\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 40,
                  "content": "    return global_var",
                  "is_issue_line": false
                },
                {
                  "line_number": 41,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "全局变量会增加代码的复杂性和测试难度。建议使用函数参数或类属性。",
              "fix_suggestions": [
                "使用函数参数传递数据",
                "使用类属性",
                "使用单例模式"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unhandled_exception",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 57,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 54,
                  "content": "    return big_list",
                  "is_issue_line": false
                },
                {
                  "line_number": 55,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 56,
                  "content": "# 缺少主函数保护",
                  "is_issue_line": false
                },
                {
                  "line_number": 57,
                  "content": "print(\"This will always execute\")",
                  "is_issue_line": true
                },
                {
                  "line_number": 58,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 59,
                  "content": "# 不安全的字符串格式化",
                  "is_issue_line": false
                },
                {
                  "line_number": 60,
                  "content": "def format_string(user_input):",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "global_variables",
              "severity": "warning",
              "message": "使用全局变量",
              "line": 38,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 35,
                  "content": "global_var = \"I'm global\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 36,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 37,
                  "content": "def use_global():",
                  "is_issue_line": false
                },
                {
                  "line_number": 38,
                  "content": "    global global_var",
                  "is_issue_line": true
                },
                {
                  "line_number": 39,
                  "content": "    global_var = \"modified\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 40,
                  "content": "    return global_var",
                  "is_issue_line": false
                },
                {
                  "line_number": 41,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "全局变量会增加代码的复杂性和测试难度。建议使用函数参数或类属性。",
              "fix_suggestions": [
                "使用函数参数传递数据",
                "使用类属性",
                "使用单例模式"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unhandled_exception",
              "severity": "warning",
              "message": "文件操作未处理异常",
              "line": 45,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 42,
                  "content": "# 不安全的文件操作",
                  "is_issue_line": false
                },
                {
                  "line_number": 43,
                  "content": "def read_file(filename):",
                  "is_issue_line": false
                },
                {
                  "line_number": 44,
                  "content": "    # 没有异常处理",
                  "is_issue_line": false
                },
                {
                  "line_number": 45,
                  "content": "    with open(filename, 'r') as f:",
                  "is_issue_line": true
                },
                {
                  "line_number": 46,
                  "content": "        content = f.read()",
                  "is_issue_line": false
                },
                {
                  "line_number": 47,
                  "content": "    return content",
                  "is_issue_line": false
                },
                {
                  "line_number": 48,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unhandled_type_conversion",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 19,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 16,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "def risky_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "    user_input = \"print('Hello')\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unhandled_type_conversion",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 57,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 54,
                  "content": "    return big_list",
                  "is_issue_line": false
                },
                {
                  "line_number": 55,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 56,
                  "content": "# 缺少主函数保护",
                  "is_issue_line": false
                },
                {
                  "line_number": 57,
                  "content": "print(\"This will always execute\")",
                  "is_issue_line": true
                },
                {
                  "line_number": 58,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 59,
                  "content": "# 不安全的字符串格式化",
                  "is_issue_line": false
                },
                {
                  "line_number": 60,
                  "content": "def format_string(user_input):",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "memory_leak",
              "severity": "warning",
              "message": "可能存在内存泄漏",
              "line": 17,
              "file": "test_java.java",
              "language": "java",
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "        // 资源泄漏",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "        FileInputStream fis = null;",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "        try {",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "            fis = new FileInputStream(\"test.txt\");",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "            // 处理文件",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "        } catch (IOException e) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "            e.printStackTrace();",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_java.java",
              "enhanced": true
            },
            {
              "type": "memory_leak",
              "severity": "warning",
              "message": "可能存在内存泄漏",
              "line": 25,
              "file": "test_java.java",
              "language": "java",
              "code_snippet": [
                {
                  "line_number": 22,
                  "content": "        // 忘记关闭文件流",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "        ",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "        // 内存泄漏风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 25,
                  "content": "        List<String> list = new ArrayList<>();",
                  "is_issue_line": true
                },
                {
                  "line_number": 26,
                  "content": "        for (int i = 0; i < 1000000; i++) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 27,
                  "content": "            list.add(\"item\" + i);",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "        }",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_java.java",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 bad_function 缺少参数验证",
              "line": 10,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 12,
                  "content": "    x = 1",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "    y = 2",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 risky_function 缺少参数验证",
              "line": 17,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "    z = x + y",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    return z",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "def risky_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "    user_input = \"print('Hello')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 process_user_data 缺少参数验证",
              "line": 23,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "def process_user_data(data):",
                  "is_issue_line": true
                },
                {
                  "line_number": 24,
                  "content": "    # 缺少类型提示和文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 25,
                  "content": "    # 缺少输入验证",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    processed = data * 2",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 divide_numbers 缺少参数验证",
              "line": 29,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 26,
                  "content": "    processed = data * 2",
                  "is_issue_line": false
                },
                {
                  "line_number": 27,
                  "content": "    return processed",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def divide_numbers(a, b):",
                  "is_issue_line": true
                },
                {
                  "line_number": 30,
                  "content": "    # 缺少异常处理",
                  "is_issue_line": false
                },
                {
                  "line_number": 31,
                  "content": "    result = a / b  # 可能除零错误",
                  "is_issue_line": false
                },
                {
                  "line_number": 32,
                  "content": "    return result",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 use_global 缺少参数验证",
              "line": 37,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 34,
                  "content": "# 全局变量（不好的实践）",
                  "is_issue_line": false
                },
                {
                  "line_number": 35,
                  "content": "global_var = \"I'm global\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 36,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 37,
                  "content": "def use_global():",
                  "is_issue_line": true
                },
                {
                  "line_number": 38,
                  "content": "    global global_var",
                  "is_issue_line": false
                },
                {
                  "line_number": 39,
                  "content": "    global_var = \"modified\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 40,
                  "content": "    return global_var",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 read_file 缺少参数验证",
              "line": 43,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 40,
                  "content": "    return global_var",
                  "is_issue_line": false
                },
                {
                  "line_number": 41,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 42,
                  "content": "# 不安全的文件操作",
                  "is_issue_line": false
                },
                {
                  "line_number": 43,
                  "content": "def read_file(filename):",
                  "is_issue_line": true
                },
                {
                  "line_number": 44,
                  "content": "    # 没有异常处理",
                  "is_issue_line": false
                },
                {
                  "line_number": 45,
                  "content": "    with open(filename, 'r') as f:",
                  "is_issue_line": false
                },
                {
                  "line_number": 46,
                  "content": "        content = f.read()",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 create_large_list 缺少参数验证",
              "line": 50,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 47,
                  "content": "    return content",
                  "is_issue_line": false
                },
                {
                  "line_number": 48,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 49,
                  "content": "# 内存泄漏风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 50,
                  "content": "def create_large_list():",
                  "is_issue_line": true
                },
                {
                  "line_number": 51,
                  "content": "    big_list = []",
                  "is_issue_line": false
                },
                {
                  "line_number": 52,
                  "content": "    for i in range(1000000):",
                  "is_issue_line": false
                },
                {
                  "line_number": 53,
                  "content": "        big_list.append(f\"item_{i}\")",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 format_string 缺少参数验证",
              "line": 60,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 57,
                  "content": "print(\"This will always execute\")",
                  "is_issue_line": false
                },
                {
                  "line_number": 58,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 59,
                  "content": "# 不安全的字符串格式化",
                  "is_issue_line": false
                },
                {
                  "line_number": 60,
                  "content": "def format_string(user_input):",
                  "is_issue_line": true
                },
                {
                  "line_number": 61,
                  "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 62,
                  "content": "    return query",
                  "is_issue_line": false
                },
                {
                  "line_number": 63,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 10,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 12,
                  "content": "    x = 1",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "    y = 2",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 23,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "def process_user_data(data):",
                  "is_issue_line": true
                },
                {
                  "line_number": 24,
                  "content": "    # 缺少类型提示和文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 25,
                  "content": "    # 缺少输入验证",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    processed = data * 2",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 37,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 34,
                  "content": "# 全局变量（不好的实践）",
                  "is_issue_line": false
                },
                {
                  "line_number": 35,
                  "content": "global_var = \"I'm global\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 36,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 37,
                  "content": "def use_global():",
                  "is_issue_line": true
                },
                {
                  "line_number": 38,
                  "content": "    global global_var",
                  "is_issue_line": false
                },
                {
                  "line_number": 39,
                  "content": "    global_var = \"modified\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 40,
                  "content": "    return global_var",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 43,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 40,
                  "content": "    return global_var",
                  "is_issue_line": false
                },
                {
                  "line_number": 41,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 42,
                  "content": "# 不安全的文件操作",
                  "is_issue_line": false
                },
                {
                  "line_number": 43,
                  "content": "def read_file(filename):",
                  "is_issue_line": true
                },
                {
                  "line_number": 44,
                  "content": "    # 没有异常处理",
                  "is_issue_line": false
                },
                {
                  "line_number": 45,
                  "content": "    with open(filename, 'r') as f:",
                  "is_issue_line": false
                },
                {
                  "line_number": 46,
                  "content": "        content = f.read()",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 50,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 47,
                  "content": "    return content",
                  "is_issue_line": false
                },
                {
                  "line_number": 48,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 49,
                  "content": "# 内存泄漏风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 50,
                  "content": "def create_large_list():",
                  "is_issue_line": true
                },
                {
                  "line_number": 51,
                  "content": "    big_list = []",
                  "is_issue_line": false
                },
                {
                  "line_number": 52,
                  "content": "    for i in range(1000000):",
                  "is_issue_line": false
                },
                {
                  "line_number": 53,
                  "content": "        big_list.append(f\"item_{i}\")",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 60,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 57,
                  "content": "print(\"This will always execute\")",
                  "is_issue_line": false
                },
                {
                  "line_number": 58,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 59,
                  "content": "# 不安全的字符串格式化",
                  "is_issue_line": false
                },
                {
                  "line_number": 60,
                  "content": "def format_string(user_input):",
                  "is_issue_line": true
                },
                {
                  "line_number": 61,
                  "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 62,
                  "content": "    return query",
                  "is_issue_line": false
                },
                {
                  "line_number": 63,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "magic_number",
              "severity": "info",
              "message": "魔法数字: 1000000",
              "line": 52,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 49,
                  "content": "# 内存泄漏风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 50,
                  "content": "def create_large_list():",
                  "is_issue_line": false
                },
                {
                  "line_number": 51,
                  "content": "    big_list = []",
                  "is_issue_line": false
                },
                {
                  "line_number": 52,
                  "content": "    for i in range(1000000):",
                  "is_issue_line": true
                },
                {
                  "line_number": 53,
                  "content": "        big_list.append(f\"item_{i}\")",
                  "is_issue_line": false
                },
                {
                  "line_number": 54,
                  "content": "    return big_list",
                  "is_issue_line": false
                },
                {
                  "line_number": 55,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "LOW",
              "message": "Possible hardcoded password: 'admin123'",
              "file": "test_python_bad.py",
              "line": 8,
              "column": 0,
              "rule": "B105",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "MEDIUM",
              "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
              "file": "test_python_bad.py",
              "line": 20,
              "column": 0,
              "rule": "B307",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 17,
                  "content": "def risky_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "    user_input = \"print('Hello')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": true
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "def process_user_data(data):",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "MEDIUM",
              "message": "Possible SQL injection vector through string-based query construction.",
              "file": "test_python_bad.py",
              "line": 61,
              "column": 0,
              "rule": "B608",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 58,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 59,
                  "content": "# 不安全的字符串格式化",
                  "is_issue_line": false
                },
                {
                  "line_number": 60,
                  "content": "def format_string(user_input):",
                  "is_issue_line": false
                },
                {
                  "line_number": 61,
                  "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                  "is_issue_line": true
                },
                {
                  "line_number": 62,
                  "content": "    return query",
                  "is_issue_line": false
                },
                {
                  "line_number": 63,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 64,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_160227\\test_zip\\test_python_bad.py",
              "enhanced": true
            }
          ],
          "detection_tools": [
            "ai_analyzer",
            "custom_analyzer",
            "bandit",
            "mypy"
          ],
          "analysis_time": 32.609379000000004,
          "summary": {
            "error_count": 8,
            "warning_count": 13,
            "info_count": 15
          },
          "languages_detected": [
            "java",
            "python"
          ]
        }
      },
      "report": {
        "summary": {},
        "issues_by_type": {},
        "issues_by_severity": {
          "error": 0,
          "warning": 0,
          "info": 0
        },
        "recommendations": [],
        "priority_issues": []
      },
      "timestamp": "2025-09-28T16:03:00.275143"
    },
    "error": null,
    "completed_at": "2025-09-28T16:03:00.275143"
  },
  "task_1ce88c77aa17": {
    "task_id": "task_1ce88c77aa17",
    "status": "completed",
    "created_at": "2025-09-28T16:02:27.616589",
    "started_at": "2025-09-28T16:02:27.616589",
    "result": {
      "success": true,
      "task_id": "task_1ce88c77aa17",
      "detection_results": {
        "success": true,
        "detection_results": {
          "project_path": "temp_extract\\project_20250928_160229",
          "total_files": 2,
          "total_issues": 39,
          "issues": [
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的密钥或密码",
              "line": 7,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的密钥或密码",
              "line": 8,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 20,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 17,
                  "content": "def risky_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "    user_input = \"print('Hello')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": true
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "def process_user_data(data):",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的API_KEY",
              "line": 7,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的SECRET",
              "line": 8,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的PASSWORD",
              "line": 8,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 20,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 17,
                  "content": "def risky_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "    user_input = \"print('Hello')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": true
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "def process_user_data(data):",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "mypy",
              "severity": "error",
              "message": "Cannot find implementation or library stub for module named \"unused_module\"  [import-not-found]",
              "file": "test_python_bad.py",
              "line": 4,
              "column": 0,
              "rule": "mypy",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "# test_python_bad.py - 有问题的Python代码示例",
                  "is_issue_line": false
                },
                {
                  "line_number": 2,
                  "content": "import os",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": true
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: os",
              "line": 2,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "# test_python_bad.py - 有问题的Python代码示例",
                  "is_issue_line": false
                },
                {
                  "line_number": 2,
                  "content": "import os",
                  "is_issue_line": true
                },
                {
                  "line_number": 3,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: sys",
              "line": 3,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "# test_python_bad.py - 有问题的Python代码示例",
                  "is_issue_line": false
                },
                {
                  "line_number": 2,
                  "content": "import os",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "import sys",
                  "is_issue_line": true
                },
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unused_import",
              "severity": "warning",
              "message": "可能未使用的导入: unused_module  # 未使用的导入",
              "line": 4,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "# test_python_bad.py - 有问题的Python代码示例",
                  "is_issue_line": false
                },
                {
                  "line_number": 2,
                  "content": "import os",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "import sys",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "import unused_module  # 未使用的导入",
                  "is_issue_line": true
                },
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
              "fix_suggestions": [
                "删除未使用的导入语句",
                "检查是否有其他文件需要这个导入",
                "使用IDE的自动清理功能"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unhandled_exception",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 19,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 16,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "def risky_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "    user_input = \"print('Hello')\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "division_by_zero_risk",
              "severity": "warning",
              "message": "可能存在除零风险",
              "line": 31,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def divide_numbers(a, b):",
                  "is_issue_line": false
                },
                {
                  "line_number": 30,
                  "content": "    # 缺少异常处理",
                  "is_issue_line": false
                },
                {
                  "line_number": 31,
                  "content": "    result = a / b  # 可能除零错误",
                  "is_issue_line": true
                },
                {
                  "line_number": 32,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 33,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 34,
                  "content": "# 全局变量（不好的实践）",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "global_variables",
              "severity": "warning",
              "message": "使用全局变量",
              "line": 38,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 35,
                  "content": "global_var = \"I'm global\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 36,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 37,
                  "content": "def use_global():",
                  "is_issue_line": false
                },
                {
                  "line_number": 38,
                  "content": "    global global_var",
                  "is_issue_line": true
                },
                {
                  "line_number": 39,
                  "content": "    global_var = \"modified\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 40,
                  "content": "    return global_var",
                  "is_issue_line": false
                },
                {
                  "line_number": 41,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "全局变量会增加代码的复杂性和测试难度。建议使用函数参数或类属性。",
              "fix_suggestions": [
                "使用函数参数传递数据",
                "使用类属性",
                "使用单例模式"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unhandled_exception",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 57,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 54,
                  "content": "    return big_list",
                  "is_issue_line": false
                },
                {
                  "line_number": 55,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 56,
                  "content": "# 缺少主函数保护",
                  "is_issue_line": false
                },
                {
                  "line_number": 57,
                  "content": "print(\"This will always execute\")",
                  "is_issue_line": true
                },
                {
                  "line_number": 58,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 59,
                  "content": "# 不安全的字符串格式化",
                  "is_issue_line": false
                },
                {
                  "line_number": 60,
                  "content": "def format_string(user_input):",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "global_variables",
              "severity": "warning",
              "message": "使用全局变量",
              "line": 38,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 35,
                  "content": "global_var = \"I'm global\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 36,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 37,
                  "content": "def use_global():",
                  "is_issue_line": false
                },
                {
                  "line_number": 38,
                  "content": "    global global_var",
                  "is_issue_line": true
                },
                {
                  "line_number": 39,
                  "content": "    global_var = \"modified\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 40,
                  "content": "    return global_var",
                  "is_issue_line": false
                },
                {
                  "line_number": 41,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "全局变量会增加代码的复杂性和测试难度。建议使用函数参数或类属性。",
              "fix_suggestions": [
                "使用函数参数传递数据",
                "使用类属性",
                "使用单例模式"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unhandled_exception",
              "severity": "warning",
              "message": "文件操作未处理异常",
              "line": 45,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 42,
                  "content": "# 不安全的文件操作",
                  "is_issue_line": false
                },
                {
                  "line_number": 43,
                  "content": "def read_file(filename):",
                  "is_issue_line": false
                },
                {
                  "line_number": 44,
                  "content": "    # 没有异常处理",
                  "is_issue_line": false
                },
                {
                  "line_number": 45,
                  "content": "    with open(filename, 'r') as f:",
                  "is_issue_line": true
                },
                {
                  "line_number": 46,
                  "content": "        content = f.read()",
                  "is_issue_line": false
                },
                {
                  "line_number": 47,
                  "content": "    return content",
                  "is_issue_line": false
                },
                {
                  "line_number": 48,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unhandled_type_conversion",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 19,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 16,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "def risky_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "    user_input = \"print('Hello')\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "unhandled_type_conversion",
              "severity": "warning",
              "message": "类型转换未处理异常",
              "line": 57,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 54,
                  "content": "    return big_list",
                  "is_issue_line": false
                },
                {
                  "line_number": 55,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 56,
                  "content": "# 缺少主函数保护",
                  "is_issue_line": false
                },
                {
                  "line_number": 57,
                  "content": "print(\"This will always execute\")",
                  "is_issue_line": true
                },
                {
                  "line_number": 58,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 59,
                  "content": "# 不安全的字符串格式化",
                  "is_issue_line": false
                },
                {
                  "line_number": 60,
                  "content": "def format_string(user_input):",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "memory_leak",
              "severity": "warning",
              "message": "可能存在内存泄漏",
              "line": 17,
              "file": "test_java.java",
              "language": "java",
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "        // 资源泄漏",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "        FileInputStream fis = null;",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "        try {",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "            fis = new FileInputStream(\"test.txt\");",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "            // 处理文件",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "        } catch (IOException e) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "            e.printStackTrace();",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_java.java",
              "enhanced": true
            },
            {
              "type": "memory_leak",
              "severity": "warning",
              "message": "可能存在内存泄漏",
              "line": 25,
              "file": "test_java.java",
              "language": "java",
              "code_snippet": [
                {
                  "line_number": 22,
                  "content": "        // 忘记关闭文件流",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "        ",
                  "is_issue_line": false
                },
                {
                  "line_number": 24,
                  "content": "        // 内存泄漏风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 25,
                  "content": "        List<String> list = new ArrayList<>();",
                  "is_issue_line": true
                },
                {
                  "line_number": 26,
                  "content": "        for (int i = 0; i < 1000000; i++) {",
                  "is_issue_line": false
                },
                {
                  "line_number": 27,
                  "content": "            list.add(\"item\" + i);",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "        }",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 2,
                "name": "警告",
                "color": "#ff8800"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_java.java",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 bad_function 缺少参数验证",
              "line": 10,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 12,
                  "content": "    x = 1",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "    y = 2",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 risky_function 缺少参数验证",
              "line": 17,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 14,
                  "content": "    z = x + y",
                  "is_issue_line": false
                },
                {
                  "line_number": 15,
                  "content": "    return z",
                  "is_issue_line": false
                },
                {
                  "line_number": 16,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 17,
                  "content": "def risky_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 18,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "    user_input = \"print('Hello')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 process_user_data 缺少参数验证",
              "line": 23,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "def process_user_data(data):",
                  "is_issue_line": true
                },
                {
                  "line_number": 24,
                  "content": "    # 缺少类型提示和文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 25,
                  "content": "    # 缺少输入验证",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    processed = data * 2",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 divide_numbers 缺少参数验证",
              "line": 29,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 26,
                  "content": "    processed = data * 2",
                  "is_issue_line": false
                },
                {
                  "line_number": 27,
                  "content": "    return processed",
                  "is_issue_line": false
                },
                {
                  "line_number": 28,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 29,
                  "content": "def divide_numbers(a, b):",
                  "is_issue_line": true
                },
                {
                  "line_number": 30,
                  "content": "    # 缺少异常处理",
                  "is_issue_line": false
                },
                {
                  "line_number": 31,
                  "content": "    result = a / b  # 可能除零错误",
                  "is_issue_line": false
                },
                {
                  "line_number": 32,
                  "content": "    return result",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 use_global 缺少参数验证",
              "line": 37,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 34,
                  "content": "# 全局变量（不好的实践）",
                  "is_issue_line": false
                },
                {
                  "line_number": 35,
                  "content": "global_var = \"I'm global\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 36,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 37,
                  "content": "def use_global():",
                  "is_issue_line": true
                },
                {
                  "line_number": 38,
                  "content": "    global global_var",
                  "is_issue_line": false
                },
                {
                  "line_number": 39,
                  "content": "    global_var = \"modified\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 40,
                  "content": "    return global_var",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 read_file 缺少参数验证",
              "line": 43,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 40,
                  "content": "    return global_var",
                  "is_issue_line": false
                },
                {
                  "line_number": 41,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 42,
                  "content": "# 不安全的文件操作",
                  "is_issue_line": false
                },
                {
                  "line_number": 43,
                  "content": "def read_file(filename):",
                  "is_issue_line": true
                },
                {
                  "line_number": 44,
                  "content": "    # 没有异常处理",
                  "is_issue_line": false
                },
                {
                  "line_number": 45,
                  "content": "    with open(filename, 'r') as f:",
                  "is_issue_line": false
                },
                {
                  "line_number": 46,
                  "content": "        content = f.read()",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 create_large_list 缺少参数验证",
              "line": 50,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 47,
                  "content": "    return content",
                  "is_issue_line": false
                },
                {
                  "line_number": 48,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 49,
                  "content": "# 内存泄漏风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 50,
                  "content": "def create_large_list():",
                  "is_issue_line": true
                },
                {
                  "line_number": 51,
                  "content": "    big_list = []",
                  "is_issue_line": false
                },
                {
                  "line_number": 52,
                  "content": "    for i in range(1000000):",
                  "is_issue_line": false
                },
                {
                  "line_number": 53,
                  "content": "        big_list.append(f\"item_{i}\")",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 format_string 缺少参数验证",
              "line": 60,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 57,
                  "content": "print(\"This will always execute\")",
                  "is_issue_line": false
                },
                {
                  "line_number": 58,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 59,
                  "content": "# 不安全的字符串格式化",
                  "is_issue_line": false
                },
                {
                  "line_number": 60,
                  "content": "def format_string(user_input):",
                  "is_issue_line": true
                },
                {
                  "line_number": 61,
                  "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 62,
                  "content": "    return query",
                  "is_issue_line": false
                },
                {
                  "line_number": 63,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 10,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 12,
                  "content": "    x = 1",
                  "is_issue_line": false
                },
                {
                  "line_number": 13,
                  "content": "    y = 2",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 23,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "def process_user_data(data):",
                  "is_issue_line": true
                },
                {
                  "line_number": 24,
                  "content": "    # 缺少类型提示和文档字符串",
                  "is_issue_line": false
                },
                {
                  "line_number": 25,
                  "content": "    # 缺少输入验证",
                  "is_issue_line": false
                },
                {
                  "line_number": 26,
                  "content": "    processed = data * 2",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 37,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 34,
                  "content": "# 全局变量（不好的实践）",
                  "is_issue_line": false
                },
                {
                  "line_number": 35,
                  "content": "global_var = \"I'm global\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 36,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 37,
                  "content": "def use_global():",
                  "is_issue_line": true
                },
                {
                  "line_number": 38,
                  "content": "    global global_var",
                  "is_issue_line": false
                },
                {
                  "line_number": 39,
                  "content": "    global_var = \"modified\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 40,
                  "content": "    return global_var",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 43,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 40,
                  "content": "    return global_var",
                  "is_issue_line": false
                },
                {
                  "line_number": 41,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 42,
                  "content": "# 不安全的文件操作",
                  "is_issue_line": false
                },
                {
                  "line_number": 43,
                  "content": "def read_file(filename):",
                  "is_issue_line": true
                },
                {
                  "line_number": 44,
                  "content": "    # 没有异常处理",
                  "is_issue_line": false
                },
                {
                  "line_number": 45,
                  "content": "    with open(filename, 'r') as f:",
                  "is_issue_line": false
                },
                {
                  "line_number": 46,
                  "content": "        content = f.read()",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 50,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 47,
                  "content": "    return content",
                  "is_issue_line": false
                },
                {
                  "line_number": 48,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 49,
                  "content": "# 内存泄漏风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 50,
                  "content": "def create_large_list():",
                  "is_issue_line": true
                },
                {
                  "line_number": 51,
                  "content": "    big_list = []",
                  "is_issue_line": false
                },
                {
                  "line_number": 52,
                  "content": "    for i in range(1000000):",
                  "is_issue_line": false
                },
                {
                  "line_number": 53,
                  "content": "        big_list.append(f\"item_{i}\")",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 60,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 57,
                  "content": "print(\"This will always execute\")",
                  "is_issue_line": false
                },
                {
                  "line_number": 58,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 59,
                  "content": "# 不安全的字符串格式化",
                  "is_issue_line": false
                },
                {
                  "line_number": 60,
                  "content": "def format_string(user_input):",
                  "is_issue_line": true
                },
                {
                  "line_number": 61,
                  "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 62,
                  "content": "    return query",
                  "is_issue_line": false
                },
                {
                  "line_number": 63,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "magic_number",
              "severity": "info",
              "message": "魔法数字: 1000000",
              "line": 52,
              "file": "test_python_bad.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 49,
                  "content": "# 内存泄漏风险",
                  "is_issue_line": false
                },
                {
                  "line_number": 50,
                  "content": "def create_large_list():",
                  "is_issue_line": false
                },
                {
                  "line_number": 51,
                  "content": "    big_list = []",
                  "is_issue_line": false
                },
                {
                  "line_number": 52,
                  "content": "    for i in range(1000000):",
                  "is_issue_line": true
                },
                {
                  "line_number": 53,
                  "content": "        big_list.append(f\"item_{i}\")",
                  "is_issue_line": false
                },
                {
                  "line_number": 54,
                  "content": "    return big_list",
                  "is_issue_line": false
                },
                {
                  "line_number": 55,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "LOW",
              "message": "Possible hardcoded password: 'admin123'",
              "file": "test_python_bad.py",
              "line": 8,
              "column": 0,
              "rule": "B105",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 5,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "# 硬编码的API密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "API_KEY = \"sk-1234567890abcdef\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 8,
                  "content": "SECRET_PASSWORD = \"admin123\"",
                  "is_issue_line": true
                },
                {
                  "line_number": 9,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 10,
                  "content": "def bad_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 11,
                  "content": "    # 缺少文档字符串",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "MEDIUM",
              "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
              "file": "test_python_bad.py",
              "line": 20,
              "column": 0,
              "rule": "B307",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 17,
                  "content": "def risky_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 18,
                  "content": "    # 不安全的eval使用",
                  "is_issue_line": false
                },
                {
                  "line_number": 19,
                  "content": "    user_input = \"print('Hello')\"",
                  "is_issue_line": false
                },
                {
                  "line_number": 20,
                  "content": "    result = eval(user_input)  # 安全风险",
                  "is_issue_line": true
                },
                {
                  "line_number": 21,
                  "content": "    return result",
                  "is_issue_line": false
                },
                {
                  "line_number": 22,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 23,
                  "content": "def process_user_data(data):",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "MEDIUM",
              "message": "Possible SQL injection vector through string-based query construction.",
              "file": "test_python_bad.py",
              "line": 61,
              "column": 0,
              "rule": "B608",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 58,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 59,
                  "content": "# 不安全的字符串格式化",
                  "is_issue_line": false
                },
                {
                  "line_number": 60,
                  "content": "def format_string(user_input):",
                  "is_issue_line": false
                },
                {
                  "line_number": 61,
                  "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                  "is_issue_line": true
                },
                {
                  "line_number": 62,
                  "content": "    return query",
                  "is_issue_line": false
                },
                {
                  "line_number": 63,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 64,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_160229\\test_zip\\test_python_bad.py",
              "enhanced": true
            }
          ],
          "detection_tools": [
            "ai_analyzer",
            "custom_analyzer",
            "bandit",
            "mypy"
          ],
          "analysis_time": 32.583479,
          "summary": {
            "error_count": 8,
            "warning_count": 13,
            "info_count": 15
          },
          "languages_detected": [
            "java",
            "python"
          ]
        }
      },
      "report": {
        "summary": {},
        "issues_by_type": {},
        "issues_by_severity": {
          "error": 0,
          "warning": 0,
          "info": 0
        },
        "recommendations": [],
        "priority_issues": []
      },
      "timestamp": "2025-09-28T16:03:02.271024"
    },
    "error": null,
    "completed_at": "2025-09-28T16:03:02.271024"
  },
  "task_c3f26f081037": {
    "task_id": "task_c3f26f081037",
    "status": "completed",
    "created_at": "2025-09-28T16:02:27.636987",
    "started_at": "2025-09-28T16:02:27.636987",
    "result": {
      "success": true,
      "task_id": "task_c3f26f081037",
      "detection_results": {
        "file_path": "uploads\\test_python_bad.py",
        "language": "python",
        "total_issues": 37,
        "issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 7,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 20,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 7,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的SECRET",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的PASSWORD",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 20,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "mypy",
            "severity": "error",
            "message": "Cannot find implementation or library stub for module named \"unused_module\"  [import-not-found]",
            "file": "test_python_bad.py",
            "line": 4,
            "column": 0,
            "rule": "mypy",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# test_python_bad.py - 有问题的Python代码示例",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": true
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: os",
            "line": 2,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# test_python_bad.py - 有问题的Python代码示例",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": true
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: sys",
            "line": 3,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# test_python_bad.py - 有问题的Python代码示例",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": true
              },
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: unused_module  # 未使用的导入",
            "line": 4,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# test_python_bad.py - 有问题的Python代码示例",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": true
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 19,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 16,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": true
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "division_by_zero_risk",
            "severity": "warning",
            "message": "可能存在除零风险",
            "line": 31,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 28,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "def divide_numbers(a, b):",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    # 缺少异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 31,
                "content": "    result = a / b  # 可能除零错误",
                "is_issue_line": true
              },
              {
                "line_number": 32,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 33,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 34,
                "content": "# 全局变量（不好的实践）",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "global_variables",
            "severity": "warning",
            "message": "使用全局变量",
            "line": 38,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 35,
                "content": "global_var = \"I'm global\"",
                "is_issue_line": false
              },
              {
                "line_number": 36,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 37,
                "content": "def use_global():",
                "is_issue_line": false
              },
              {
                "line_number": 38,
                "content": "    global global_var",
                "is_issue_line": true
              },
              {
                "line_number": 39,
                "content": "    global_var = \"modified\"",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "全局变量会增加代码的复杂性和测试难度。建议使用函数参数或类属性。",
            "fix_suggestions": [
              "使用函数参数传递数据",
              "使用类属性",
              "使用单例模式"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 57,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 54,
                "content": "    return big_list",
                "is_issue_line": false
              },
              {
                "line_number": 55,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 56,
                "content": "# 缺少主函数保护",
                "is_issue_line": false
              },
              {
                "line_number": 57,
                "content": "print(\"This will always execute\")",
                "is_issue_line": true
              },
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "global_variables",
            "severity": "warning",
            "message": "使用全局变量",
            "line": 38,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 35,
                "content": "global_var = \"I'm global\"",
                "is_issue_line": false
              },
              {
                "line_number": 36,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 37,
                "content": "def use_global():",
                "is_issue_line": false
              },
              {
                "line_number": 38,
                "content": "    global global_var",
                "is_issue_line": true
              },
              {
                "line_number": 39,
                "content": "    global_var = \"modified\"",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "全局变量会增加代码的复杂性和测试难度。建议使用函数参数或类属性。",
            "fix_suggestions": [
              "使用函数参数传递数据",
              "使用类属性",
              "使用单例模式"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "文件操作未处理异常",
            "line": 45,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 42,
                "content": "# 不安全的文件操作",
                "is_issue_line": false
              },
              {
                "line_number": 43,
                "content": "def read_file(filename):",
                "is_issue_line": false
              },
              {
                "line_number": 44,
                "content": "    # 没有异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 45,
                "content": "    with open(filename, 'r') as f:",
                "is_issue_line": true
              },
              {
                "line_number": 46,
                "content": "        content = f.read()",
                "is_issue_line": false
              },
              {
                "line_number": 47,
                "content": "    return content",
                "is_issue_line": false
              },
              {
                "line_number": 48,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_type_conversion",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 19,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 16,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": true
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_type_conversion",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 57,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 54,
                "content": "    return big_list",
                "is_issue_line": false
              },
              {
                "line_number": 55,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 56,
                "content": "# 缺少主函数保护",
                "is_issue_line": false
              },
              {
                "line_number": 57,
                "content": "print(\"This will always execute\")",
                "is_issue_line": true
              },
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 bad_function 缺少参数验证",
            "line": 10,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": true
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "    x = 1",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "    y = 2",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 risky_function 缺少参数验证",
            "line": 17,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 14,
                "content": "    z = x + y",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    return z",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": true
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 process_user_data 缺少参数验证",
            "line": 23,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": true
              },
              {
                "line_number": 24,
                "content": "    # 缺少类型提示和文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 25,
                "content": "    # 缺少输入验证",
                "is_issue_line": false
              },
              {
                "line_number": 26,
                "content": "    processed = data * 2",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 divide_numbers 缺少参数验证",
            "line": 29,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 26,
                "content": "    processed = data * 2",
                "is_issue_line": false
              },
              {
                "line_number": 27,
                "content": "    return processed",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "def divide_numbers(a, b):",
                "is_issue_line": true
              },
              {
                "line_number": 30,
                "content": "    # 缺少异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 31,
                "content": "    result = a / b  # 可能除零错误",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "    return result",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 use_global 缺少参数验证",
            "line": 37,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 34,
                "content": "# 全局变量（不好的实践）",
                "is_issue_line": false
              },
              {
                "line_number": 35,
                "content": "global_var = \"I'm global\"",
                "is_issue_line": false
              },
              {
                "line_number": 36,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 37,
                "content": "def use_global():",
                "is_issue_line": true
              },
              {
                "line_number": 38,
                "content": "    global global_var",
                "is_issue_line": false
              },
              {
                "line_number": 39,
                "content": "    global_var = \"modified\"",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 read_file 缺少参数验证",
            "line": 43,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 42,
                "content": "# 不安全的文件操作",
                "is_issue_line": false
              },
              {
                "line_number": 43,
                "content": "def read_file(filename):",
                "is_issue_line": true
              },
              {
                "line_number": 44,
                "content": "    # 没有异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 45,
                "content": "    with open(filename, 'r') as f:",
                "is_issue_line": false
              },
              {
                "line_number": 46,
                "content": "        content = f.read()",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 create_large_list 缺少参数验证",
            "line": 50,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 47,
                "content": "    return content",
                "is_issue_line": false
              },
              {
                "line_number": 48,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 49,
                "content": "# 内存泄漏风险",
                "is_issue_line": false
              },
              {
                "line_number": 50,
                "content": "def create_large_list():",
                "is_issue_line": true
              },
              {
                "line_number": 51,
                "content": "    big_list = []",
                "is_issue_line": false
              },
              {
                "line_number": 52,
                "content": "    for i in range(1000000):",
                "is_issue_line": false
              },
              {
                "line_number": 53,
                "content": "        big_list.append(f\"item_{i}\")",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 format_string 缺少参数验证",
            "line": 60,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 57,
                "content": "print(\"This will always execute\")",
                "is_issue_line": false
              },
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": true
              },
              {
                "line_number": 61,
                "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                "is_issue_line": false
              },
              {
                "line_number": 62,
                "content": "    return query",
                "is_issue_line": false
              },
              {
                "line_number": 63,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 10,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": true
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "    x = 1",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "    y = 2",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 23,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": true
              },
              {
                "line_number": 24,
                "content": "    # 缺少类型提示和文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 25,
                "content": "    # 缺少输入验证",
                "is_issue_line": false
              },
              {
                "line_number": 26,
                "content": "    processed = data * 2",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 37,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 34,
                "content": "# 全局变量（不好的实践）",
                "is_issue_line": false
              },
              {
                "line_number": 35,
                "content": "global_var = \"I'm global\"",
                "is_issue_line": false
              },
              {
                "line_number": 36,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 37,
                "content": "def use_global():",
                "is_issue_line": true
              },
              {
                "line_number": 38,
                "content": "    global global_var",
                "is_issue_line": false
              },
              {
                "line_number": 39,
                "content": "    global_var = \"modified\"",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 43,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 42,
                "content": "# 不安全的文件操作",
                "is_issue_line": false
              },
              {
                "line_number": 43,
                "content": "def read_file(filename):",
                "is_issue_line": true
              },
              {
                "line_number": 44,
                "content": "    # 没有异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 45,
                "content": "    with open(filename, 'r') as f:",
                "is_issue_line": false
              },
              {
                "line_number": 46,
                "content": "        content = f.read()",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 50,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 47,
                "content": "    return content",
                "is_issue_line": false
              },
              {
                "line_number": 48,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 49,
                "content": "# 内存泄漏风险",
                "is_issue_line": false
              },
              {
                "line_number": 50,
                "content": "def create_large_list():",
                "is_issue_line": true
              },
              {
                "line_number": 51,
                "content": "    big_list = []",
                "is_issue_line": false
              },
              {
                "line_number": 52,
                "content": "    for i in range(1000000):",
                "is_issue_line": false
              },
              {
                "line_number": 53,
                "content": "        big_list.append(f\"item_{i}\")",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 60,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 57,
                "content": "print(\"This will always execute\")",
                "is_issue_line": false
              },
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": true
              },
              {
                "line_number": 61,
                "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                "is_issue_line": false
              },
              {
                "line_number": 62,
                "content": "    return query",
                "is_issue_line": false
              },
              {
                "line_number": 63,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 1000000",
            "line": 52,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 49,
                "content": "# 内存泄漏风险",
                "is_issue_line": false
              },
              {
                "line_number": 50,
                "content": "def create_large_list():",
                "is_issue_line": false
              },
              {
                "line_number": 51,
                "content": "    big_list = []",
                "is_issue_line": false
              },
              {
                "line_number": 52,
                "content": "    for i in range(1000000):",
                "is_issue_line": true
              },
              {
                "line_number": 53,
                "content": "        big_list.append(f\"item_{i}\")",
                "is_issue_line": false
              },
              {
                "line_number": 54,
                "content": "    return big_list",
                "is_issue_line": false
              },
              {
                "line_number": 55,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "LOW",
            "message": "Possible hardcoded password: 'admin123'",
            "file": "test_python_bad.py",
            "line": 8,
            "column": 0,
            "rule": "B105",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "MEDIUM",
            "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
            "file": "test_python_bad.py",
            "line": 20,
            "column": 0,
            "rule": "B307",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "MEDIUM",
            "message": "Possible SQL injection vector through string-based query construction.",
            "file": "test_python_bad.py",
            "line": 61,
            "column": 0,
            "rule": "B608",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 61,
                "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                "is_issue_line": true
              },
              {
                "line_number": 62,
                "content": "    return query",
                "is_issue_line": false
              },
              {
                "line_number": 63,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 64,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          }
        ],
        "detection_tools": [
          "custom_analyzer",
          "bandit",
          "mypy"
        ],
        "analysis_time": 1.853594,
        "summary": {
          "error_count": 8,
          "warning_count": 11,
          "info_count": 15
        },
        "enhanced": true
      },
      "report": {
        "summary": {
          "error_count": 8,
          "warning_count": 11,
          "info_count": 15
        },
        "issues_by_type": {
          "hardcoded_secrets": 5,
          "unsafe_eval": 2,
          "mypy": 1,
          "unused_import": 3,
          "unhandled_exception": 3,
          "division_by_zero_risk": 1,
          "global_variables": 2,
          "unhandled_type_conversion": 2,
          "missing_parameter_validation": 8,
          "missing_docstring": 6,
          "magic_number": 1,
          "bandit": 3
        },
        "issues_by_severity": {
          "error": 8,
          "warning": 11,
          "info": 15
        },
        "recommendations": [
          "发现严重错误，建议优先修复",
          "警告数量较多，建议进行代码审查"
        ],
        "priority_issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 7,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 20,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 7,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的SECRET",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          }
        ]
      },
      "timestamp": "2025-09-28T16:02:33.438689"
    },
    "error": null,
    "completed_at": "2025-09-28T16:02:33.438689"
  },
  "task_8efd5eb9120a": {
    "task_id": "task_8efd5eb9120a",
    "status": "completed",
    "created_at": "2025-09-28T16:03:47.442640",
    "started_at": "2025-09-28T16:03:47.442640",
    "result": {
      "success": true,
      "task_id": "task_8efd5eb9120a",
      "detection_results": {
        "success": true,
        "detection_results": {
          "project_path": "temp_extract\\project_20250928_160347",
          "total_files": 1,
          "total_issues": 8,
          "issues": [
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的密钥或密码",
              "line": 3,
              "file": "test.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 2,
                  "content": "# 测试文件",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                  "is_issue_line": true
                },
                {
                  "line_number": 4,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "def test_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    return eval(\"1+1\")  # 不安全eval",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160347\\test.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 6,
              "file": "test.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "def test_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    return eval(\"1+1\")  # 不安全eval",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160347\\test.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的API_KEY",
              "line": 3,
              "file": "test.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 2,
                  "content": "# 测试文件",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                  "is_issue_line": true
                },
                {
                  "line_number": 4,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "def test_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    return eval(\"1+1\")  # 不安全eval",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160347\\test.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 6,
              "file": "test.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "def test_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    return eval(\"1+1\")  # 不安全eval",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160347\\test.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 test_function 缺少参数验证",
              "line": 5,
              "file": "test.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 2,
                  "content": "# 测试文件",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "def test_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 6,
                  "content": "    return eval(\"1+1\")  # 不安全eval",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160347\\test.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 5,
              "file": "test.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 2,
                  "content": "# 测试文件",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "def test_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 6,
                  "content": "    return eval(\"1+1\")  # 不安全eval",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160347\\test.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "缺少参数验证",
              "line": 5,
              "file": "test.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 2,
                  "content": "# 测试文件",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "def test_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 6,
                  "content": "    return eval(\"1+1\")  # 不安全eval",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160347\\test.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "MEDIUM",
              "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
              "file": "test.py",
              "line": 6,
              "column": 0,
              "rule": "B307",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "def test_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    return eval(\"1+1\")  # 不安全eval",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_160347\\test.py",
              "enhanced": true
            }
          ],
          "detection_tools": [
            "bandit",
            "mypy",
            "custom_analyzer"
          ],
          "analysis_time": 1.6112920000000002,
          "summary": {
            "error_count": 4,
            "warning_count": 0,
            "info_count": 3
          },
          "languages_detected": [
            "python"
          ]
        }
      },
      "report": {
        "summary": {},
        "issues_by_type": {},
        "issues_by_severity": {
          "error": 0,
          "warning": 0,
          "info": 0
        },
        "recommendations": [],
        "priority_issues": []
      },
      "timestamp": "2025-09-28T16:03:49.085892"
    },
    "error": null,
    "completed_at": "2025-09-28T16:03:49.085892"
  },
  "task_a50a700a94d0": {
    "task_id": "task_a50a700a94d0",
    "status": "completed",
    "created_at": "2025-09-28T16:04:25.286289",
    "started_at": "2025-09-28T16:04:25.286289",
    "result": {
      "success": true,
      "task_id": "task_a50a700a94d0",
      "detection_results": {
        "success": true,
        "detection_results": {
          "project_path": "temp_extract\\project_20250928_160425",
          "total_files": 1,
          "total_issues": 8,
          "issues": [
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的密钥或密码",
              "line": 3,
              "file": "test.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 2,
                  "content": "# 测试文件",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                  "is_issue_line": true
                },
                {
                  "line_number": 4,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "def test_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    return eval(\"1+1\")  # 不安全eval",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160425\\test.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 6,
              "file": "test.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "def test_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    return eval(\"1+1\")  # 不安全eval",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160425\\test.py",
              "enhanced": true
            },
            {
              "type": "hardcoded_secrets",
              "severity": "error",
              "message": "发现硬编码的API_KEY",
              "line": 3,
              "file": "test.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 1,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 2,
                  "content": "# 测试文件",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                  "is_issue_line": true
                },
                {
                  "line_number": 4,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "def test_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    return eval(\"1+1\")  # 不安全eval",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
              "fix_suggestions": [
                "使用环境变量存储敏感信息",
                "使用配置文件（不提交到版本控制）",
                "使用密钥管理服务"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160425\\test.py",
              "enhanced": true
            },
            {
              "type": "unsafe_eval",
              "severity": "error",
              "message": "不安全的eval使用",
              "line": 6,
              "file": "test.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "def test_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    return eval(\"1+1\")  # 不安全eval",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
              "fix_suggestions": [
                "使用ast.literal_eval()替代eval()",
                "使用json.loads()解析JSON数据",
                "使用专门的解析库"
              ],
              "severity_info": {
                "level": 1,
                "name": "错误",
                "color": "#ff4444"
              },
              "file_path": "temp_extract\\project_20250928_160425\\test.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "函数 test_function 缺少参数验证",
              "line": 5,
              "file": "test.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 2,
                  "content": "# 测试文件",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "def test_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 6,
                  "content": "    return eval(\"1+1\")  # 不安全eval",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160425\\test.py",
              "enhanced": true
            },
            {
              "type": "missing_docstring",
              "severity": "info",
              "message": "函数缺少文档字符串",
              "line": 5,
              "file": "test.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 2,
                  "content": "# 测试文件",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "def test_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 6,
                  "content": "    return eval(\"1+1\")  # 不安全eval",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160425\\test.py",
              "enhanced": true
            },
            {
              "type": "missing_parameter_validation",
              "severity": "info",
              "message": "缺少参数验证",
              "line": 5,
              "file": "test.py",
              "language": "python",
              "column": 0,
              "code_snippet": [
                {
                  "line_number": 2,
                  "content": "# 测试文件",
                  "is_issue_line": false
                },
                {
                  "line_number": 3,
                  "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "def test_function():",
                  "is_issue_line": true
                },
                {
                  "line_number": 6,
                  "content": "    return eval(\"1+1\")  # 不安全eval",
                  "is_issue_line": false
                },
                {
                  "line_number": 7,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {
                "level": 3,
                "name": "信息",
                "color": "#4488ff"
              },
              "file_path": "temp_extract\\project_20250928_160425\\test.py",
              "enhanced": true
            },
            {
              "type": "bandit",
              "severity": "MEDIUM",
              "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
              "file": "test.py",
              "line": 6,
              "column": 0,
              "rule": "B307",
              "language": "python",
              "code_snippet": [
                {
                  "line_number": 3,
                  "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                  "is_issue_line": false
                },
                {
                  "line_number": 4,
                  "content": "",
                  "is_issue_line": false
                },
                {
                  "line_number": 5,
                  "content": "def test_function():",
                  "is_issue_line": false
                },
                {
                  "line_number": 6,
                  "content": "    return eval(\"1+1\")  # 不安全eval",
                  "is_issue_line": true
                },
                {
                  "line_number": 7,
                  "content": "",
                  "is_issue_line": false
                }
              ],
              "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
              "fix_suggestions": [
                "建议根据具体情况进行修复"
              ],
              "severity_info": {},
              "file_path": "temp_extract\\project_20250928_160425\\test.py",
              "enhanced": true
            }
          ],
          "detection_tools": [
            "bandit",
            "custom_analyzer",
            "mypy"
          ],
          "analysis_time": 1.4161409999999999,
          "summary": {
            "error_count": 4,
            "warning_count": 0,
            "info_count": 3
          },
          "languages_detected": [
            "python"
          ]
        }
      },
      "report": {
        "summary": {},
        "issues_by_type": {},
        "issues_by_severity": {
          "error": 0,
          "warning": 0,
          "info": 0
        },
        "recommendations": [],
        "priority_issues": []
      },
      "timestamp": "2025-09-28T16:04:26.738109"
    },
    "error": null,
    "completed_at": "2025-09-28T16:04:26.738109"
  },
  "task_c9333eacf8e0": {
    "task_id": "task_c9333eacf8e0",
    "status": "completed",
    "created_at": "2025-09-28T16:07:32.362625",
    "started_at": "2025-09-28T16:07:32.362625",
    "result": {
      "success": true,
      "task_id": "task_c9333eacf8e0",
      "detection_results": {
        "project_path": "temp_extract\\project_20250928_160732",
        "total_files": 1,
        "total_issues": 8,
        "issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 3,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "# 测试文件",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160732\\test.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 6,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": true
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160732\\test.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 3,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "# 测试文件",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160732\\test.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 6,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": true
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160732\\test.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 test_function 缺少参数验证",
            "line": 5,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "# 测试文件",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_160732\\test.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 5,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "# 测试文件",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_160732\\test.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "缺少参数验证",
            "line": 5,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "# 测试文件",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_160732\\test.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "MEDIUM",
            "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
            "file": "test.py",
            "line": 6,
            "column": 0,
            "rule": "B307",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": true
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "temp_extract\\project_20250928_160732\\test.py",
            "enhanced": true
          }
        ],
        "detection_tools": [
          "mypy",
          "bandit",
          "custom_analyzer"
        ],
        "analysis_time": 1.582866,
        "summary": {
          "error_count": 4,
          "warning_count": 0,
          "info_count": 3
        },
        "languages_detected": [
          "python"
        ]
      },
      "report": {
        "summary": {
          "error_count": 4,
          "warning_count": 0,
          "info_count": 3
        },
        "issues_by_type": {
          "hardcoded_secrets": 2,
          "unsafe_eval": 2,
          "missing_parameter_validation": 2,
          "missing_docstring": 1,
          "bandit": 1
        },
        "issues_by_severity": {
          "error": 4,
          "warning": 0,
          "info": 3
        },
        "recommendations": [
          "发现严重错误，建议优先修复"
        ],
        "priority_issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 3,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "# 测试文件",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160732\\test.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 6,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": true
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160732\\test.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 3,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "# 测试文件",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160732\\test.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 6,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": true
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160732\\test.py",
            "enhanced": true
          }
        ]
      },
      "timestamp": "2025-09-28T16:07:33.978618"
    },
    "error": null,
    "completed_at": "2025-09-28T16:07:33.978618"
  },
  "task_20f799160ef2": {
    "task_id": "task_20f799160ef2",
    "status": "completed",
    "created_at": "2025-09-28T16:08:38.867888",
    "started_at": "2025-09-28T16:08:38.867888",
    "result": {
      "success": true,
      "task_id": "task_20f799160ef2",
      "detection_results": {
        "project_path": "temp_extract\\project_20250928_160838",
        "total_files": 4,
        "total_issues": 27,
        "issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 10,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 7,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "# 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 11,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def unsafe_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 11,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "# 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def unsafe_function():",
                "is_issue_line": false
              },
              {
                "line_number": 14,
                "content": "    \"\"\"不安全的函数\"\"\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 17,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 14,
                "content": "    \"\"\"不安全的函数\"\"\"",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "    user_input = \"print('Hello World')\"",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "    result = eval(user_input)",
                "is_issue_line": true
              },
              {
                "line_number": 18,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "def missing_docstring_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 10,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 7,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "# 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 11,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def unsafe_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的SECRET",
            "line": 11,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "# 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def unsafe_function():",
                "is_issue_line": false
              },
              {
                "line_number": 14,
                "content": "    \"\"\"不安全的函数\"\"\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的PASSWORD",
            "line": 11,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "# 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def unsafe_function():",
                "is_issue_line": false
              },
              {
                "line_number": 14,
                "content": "    \"\"\"不安全的函数\"\"\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 17,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 14,
                "content": "    \"\"\"不安全的函数\"\"\"",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "    user_input = \"print('Hello World')\"",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "    result = eval(user_input)",
                "is_issue_line": true
              },
              {
                "line_number": 18,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "def missing_docstring_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "mypy",
            "severity": "error",
            "message": "Cannot find implementation or library stub for module named \"unused_module\"  [import-not-found]",
            "file": "test_python_with_issues.py",
            "line": 26,
            "column": 0,
            "rule": "mypy",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 23,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 24,
                "content": "def unused_import_test():",
                "is_issue_line": false
              },
              {
                "line_number": 25,
                "content": "    # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 26,
                "content": "    import unused_module",
                "is_issue_line": true
              },
              {
                "line_number": 27,
                "content": "    return \"test\"",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "def main():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "null_pointer_dereference",
            "severity": "error",
            "message": "潜在的空指针解引用",
            "line": 6,
            "file": "test_java_with_issues.java",
            "language": "java",
            "code_snippet": [
              {
                "line_number": 3,
                "content": "    public static void main(String[] args) {",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "        // 空指针解引用风险",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "        String str = null;",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "        if (str == null) {",
                "is_issue_line": true
              },
              {
                "line_number": 7,
                "content": "            System.out.println(\"String is null\");",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "        }",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "        ",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_java_with_issues.java",
            "enhanced": true
          },
          {
            "type": "buffer_overflow",
            "severity": "error",
            "message": "缓冲区溢出风险",
            "line": 8,
            "file": "test_c_with_issues.c",
            "language": "c",
            "code_snippet": [
              {
                "line_number": 5,
                "content": "int main() {",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    // 缓冲区溢出风险",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "    char buffer[10];",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "    strcpy(buffer, \"This is a very long string that will cause buffer overflow\");",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "    ",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "    // 内存泄漏",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    char* ptr = malloc(100);",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_c_with_issues.c",
            "enhanced": true
          },
          {
            "type": "xss_vulnerability",
            "severity": "error",
            "message": "XSS漏洞风险",
            "line": 5,
            "file": "test_js_with_issues.js",
            "language": "javascript",
            "code_snippet": [
              {
                "line_number": 2,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "// XSS漏洞风险",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "function displayUserInput(userInput) {",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "    document.getElementById('output').innerHTML = userInput;",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "    document.write(userInput);",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "}",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_js_with_issues.js",
            "enhanced": true
          },
          {
            "type": "xss_vulnerability",
            "severity": "error",
            "message": "XSS漏洞风险",
            "line": 6,
            "file": "test_js_with_issues.js",
            "language": "javascript",
            "code_snippet": [
              {
                "line_number": 3,
                "content": "// XSS漏洞风险",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "function displayUserInput(userInput) {",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "    document.getElementById('output').innerHTML = userInput;",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    document.write(userInput);",
                "is_issue_line": true
              },
              {
                "line_number": 7,
                "content": "}",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "// 未使用的变量",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_js_with_issues.js",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: os",
            "line": 6,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 3,
                "content": "测试文件 - 包含各种缺陷",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "\"\"\"",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "import os",
                "is_issue_line": true
              },
              {
                "line_number": 7,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "# 硬编码密钥",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: sys",
            "line": 7,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "\"\"\"",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "import sys",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "# 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: unused_module",
            "line": 26,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 23,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 24,
                "content": "def unused_import_test():",
                "is_issue_line": false
              },
              {
                "line_number": 25,
                "content": "    # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 26,
                "content": "    import unused_module",
                "is_issue_line": true
              },
              {
                "line_number": 27,
                "content": "    return \"test\"",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "def main():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "division_by_zero_risk",
            "severity": "warning",
            "message": "可能存在除零风险",
            "line": 1,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "#!/usr/bin/env python3",
                "is_issue_line": true
              },
              {
                "line_number": 2,
                "content": "\"\"\"",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "测试文件 - 包含各种缺陷",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "\"\"\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 16,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 13,
                "content": "def unsafe_function():",
                "is_issue_line": false
              },
              {
                "line_number": 14,
                "content": "    \"\"\"不安全的函数\"\"\"",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "    user_input = \"print('Hello World')\"",
                "is_issue_line": true
              },
              {
                "line_number": 17,
                "content": "    result = eval(user_input)",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 30,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "    return \"test\"",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "def main():",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    print(\"测试文件运行中...\")",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    unsafe_function()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "    missing_docstring_function()",
                "is_issue_line": false
              },
              {
                "line_number": 33,
                "content": "    unused_import_test()",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "unhandled_type_conversion",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 16,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 13,
                "content": "def unsafe_function():",
                "is_issue_line": false
              },
              {
                "line_number": 14,
                "content": "    \"\"\"不安全的函数\"\"\"",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "    user_input = \"print('Hello World')\"",
                "is_issue_line": true
              },
              {
                "line_number": 17,
                "content": "    result = eval(user_input)",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "unhandled_type_conversion",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 30,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 27,
                "content": "    return \"test\"",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "def main():",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    print(\"测试文件运行中...\")",
                "is_issue_line": true
              },
              {
                "line_number": 31,
                "content": "    unsafe_function()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "    missing_docstring_function()",
                "is_issue_line": false
              },
              {
                "line_number": 33,
                "content": "    unused_import_test()",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 unsafe_function 缺少参数验证",
            "line": 13,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 10,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def unsafe_function():",
                "is_issue_line": true
              },
              {
                "line_number": 14,
                "content": "    \"\"\"不安全的函数\"\"\"",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "    user_input = \"print('Hello World')\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 missing_docstring_function 缺少参数验证",
            "line": 20,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 17,
                "content": "    result = eval(user_input)",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "def missing_docstring_function():",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "    return \"test\"",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 unused_import_test 缺少参数验证",
            "line": 24,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 21,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "    return \"test\"",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 24,
                "content": "def unused_import_test():",
                "is_issue_line": true
              },
              {
                "line_number": 25,
                "content": "    # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 26,
                "content": "    import unused_module",
                "is_issue_line": false
              },
              {
                "line_number": 27,
                "content": "    return \"test\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 main 缺少参数验证",
            "line": 29,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 26,
                "content": "    import unused_module",
                "is_issue_line": false
              },
              {
                "line_number": 27,
                "content": "    return \"test\"",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "def main():",
                "is_issue_line": true
              },
              {
                "line_number": 30,
                "content": "    print(\"测试文件运行中...\")",
                "is_issue_line": false
              },
              {
                "line_number": 31,
                "content": "    unsafe_function()",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "    missing_docstring_function()",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 24,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 21,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "    return \"test\"",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 24,
                "content": "def unused_import_test():",
                "is_issue_line": true
              },
              {
                "line_number": 25,
                "content": "    # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 26,
                "content": "    import unused_module",
                "is_issue_line": false
              },
              {
                "line_number": 27,
                "content": "    return \"test\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "LOW",
            "message": "Possible hardcoded password: 'admin123'",
            "file": "test_python_with_issues.py",
            "line": 11,
            "column": 0,
            "rule": "B105",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "# 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def unsafe_function():",
                "is_issue_line": false
              },
              {
                "line_number": 14,
                "content": "    \"\"\"不安全的函数\"\"\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "MEDIUM",
            "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
            "file": "test_python_with_issues.py",
            "line": 17,
            "column": 0,
            "rule": "B307",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 14,
                "content": "    \"\"\"不安全的函数\"\"\"",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "    user_input = \"print('Hello World')\"",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "    result = eval(user_input)",
                "is_issue_line": true
              },
              {
                "line_number": 18,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "def missing_docstring_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          }
        ],
        "detection_tools": [
          "mypy",
          "custom_analyzer",
          "ai_analyzer",
          "bandit"
        ],
        "analysis_time": 69.52983499999999,
        "summary": {
          "error_count": 12,
          "warning_count": 8,
          "info_count": 5
        },
        "languages_detected": [
          "javascript",
          "java",
          "c",
          "python"
        ]
      },
      "report": {
        "summary": {
          "error_count": 12,
          "warning_count": 8,
          "info_count": 5
        },
        "issues_by_type": {
          "hardcoded_secrets": 5,
          "unsafe_eval": 2,
          "mypy": 1,
          "null_pointer_dereference": 1,
          "buffer_overflow": 1,
          "xss_vulnerability": 2,
          "unused_import": 3,
          "division_by_zero_risk": 1,
          "unhandled_exception": 2,
          "unhandled_type_conversion": 2,
          "missing_parameter_validation": 4,
          "missing_docstring": 1,
          "bandit": 2
        },
        "issues_by_severity": {
          "error": 12,
          "warning": 8,
          "info": 5
        },
        "recommendations": [
          "发现严重错误，建议优先修复"
        ],
        "priority_issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 10,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 7,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "# 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 11,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def unsafe_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 11,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "# 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def unsafe_function():",
                "is_issue_line": false
              },
              {
                "line_number": 14,
                "content": "    \"\"\"不安全的函数\"\"\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 17,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 14,
                "content": "    \"\"\"不安全的函数\"\"\"",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "    user_input = \"print('Hello World')\"",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "    result = eval(user_input)",
                "is_issue_line": true
              },
              {
                "line_number": 18,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "def missing_docstring_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 10,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 7,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "# 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 11,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def unsafe_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的SECRET",
            "line": 11,
            "file": "test_python_with_issues.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "# 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 12,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "def unsafe_function():",
                "is_issue_line": false
              },
              {
                "line_number": 14,
                "content": "    \"\"\"不安全的函数\"\"\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_160838\\test_python_with_issues.py",
            "enhanced": true
          }
        ]
      },
      "timestamp": "2025-09-28T16:09:48.551317"
    },
    "error": null,
    "completed_at": "2025-09-28T16:09:48.551317"
  },
  "task_9a7d9321088b": {
    "task_id": "task_9a7d9321088b",
    "status": "completed",
    "created_at": "2025-09-28T16:12:23.099121",
    "started_at": "2025-09-28T16:12:23.099121",
    "result": {
      "success": true,
      "task_id": "task_9a7d9321088b",
      "detection_results": {
        "project_path": "temp_extract\\project_20250928_161223",
        "total_files": 1,
        "total_issues": 8,
        "issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 3,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "# 测试文件",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_161223\\test.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 6,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": true
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_161223\\test.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 3,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "# 测试文件",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_161223\\test.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 6,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": true
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_161223\\test.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 test_function 缺少参数验证",
            "line": 5,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "# 测试文件",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_161223\\test.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 5,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "# 测试文件",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_161223\\test.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "缺少参数验证",
            "line": 5,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 2,
                "content": "# 测试文件",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": true
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_161223\\test.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "MEDIUM",
            "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
            "file": "test.py",
            "line": 6,
            "column": 0,
            "rule": "B307",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": true
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "temp_extract\\project_20250928_161223\\test.py",
            "enhanced": true
          }
        ],
        "detection_tools": [
          "mypy",
          "custom_analyzer",
          "bandit"
        ],
        "analysis_time": 1.6322290000000002,
        "summary": {
          "error_count": 4,
          "warning_count": 0,
          "info_count": 3
        },
        "languages_detected": [
          "python"
        ]
      },
      "report": {
        "summary": {
          "error_count": 4,
          "warning_count": 0,
          "info_count": 3
        },
        "issues_by_type": {
          "hardcoded_secrets": 2,
          "unsafe_eval": 2,
          "missing_parameter_validation": 2,
          "missing_docstring": 1,
          "bandit": 1
        },
        "issues_by_severity": {
          "error": 4,
          "warning": 0,
          "info": 3
        },
        "recommendations": [
          "发现严重错误，建议优先修复"
        ],
        "priority_issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 3,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "# 测试文件",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_161223\\test.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 6,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": true
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_161223\\test.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 3,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "# 测试文件",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": true
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_161223\\test.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 6,
            "file": "test.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 3,
                "content": "API_KEY = \"secret123\"  # 硬编码密钥",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "def test_function():",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return eval(\"1+1\")  # 不安全eval",
                "is_issue_line": true
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_161223\\test.py",
            "enhanced": true
          }
        ]
      },
      "timestamp": "2025-09-28T16:12:24.771898"
    },
    "error": null,
    "completed_at": "2025-09-28T16:12:24.771898"
  },
  "task_035b6cc9fbf8": {
    "task_id": "task_035b6cc9fbf8",
    "status": "completed",
    "created_at": "2025-09-28T16:19:41.738895",
    "started_at": "2025-09-28T16:19:41.738895",
    "result": {
      "success": true,
      "task_id": "task_035b6cc9fbf8",
      "detection_results": {
        "file_path": "uploads\\test_python.py",
        "language": "python",
        "total_issues": 1,
        "issues": [
          {
            "type": "syntax_error",
            "severity": "error",
            "message": "语法错误: source code string cannot contain null bytes",
            "line": 1,
            "file": "test_python.py",
            "language": "python",
            "column": 0
          }
        ],
        "detection_tools": [
          "custom_analyzer",
          "bandit",
          "mypy"
        ],
        "analysis_time": 1.460399,
        "summary": {
          "error_count": 1,
          "warning_count": 0,
          "info_count": 0
        }
      },
      "report": {
        "summary": {
          "error_count": 1,
          "warning_count": 0,
          "info_count": 0
        },
        "issues_by_type": {
          "syntax_error": 1
        },
        "issues_by_severity": {
          "error": 1,
          "warning": 0,
          "info": 0
        },
        "recommendations": [
          "发现严重错误，建议优先修复"
        ],
        "priority_issues": [
          {
            "type": "syntax_error",
            "severity": "error",
            "message": "语法错误: source code string cannot contain null bytes",
            "line": 1,
            "file": "test_python.py",
            "language": "python",
            "column": 0
          }
        ]
      },
      "timestamp": "2025-09-28T16:19:43.361735"
    },
    "error": null,
    "completed_at": "2025-09-28T16:19:43.361735"
  },
  "task_989812e515b1": {
    "task_id": "task_989812e515b1",
    "status": "completed",
    "created_at": "2025-09-28T16:20:08.702981",
    "started_at": "2025-09-28T16:20:08.702981",
    "result": {
      "success": true,
      "task_id": "task_989812e515b1",
      "detection_results": {
        "project_path": "temp_extract\\project_20250928_162008",
        "total_files": 2,
        "total_issues": 39,
        "issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 7,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 20,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 7,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的SECRET",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的PASSWORD",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 20,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "mypy",
            "severity": "error",
            "message": "Cannot find implementation or library stub for module named \"unused_module\"  [import-not-found]",
            "file": "test_python_bad.py",
            "line": 4,
            "column": 0,
            "rule": "mypy",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# test_python_bad.py - 有问题的Python代码示例",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": true
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: os",
            "line": 2,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# test_python_bad.py - 有问题的Python代码示例",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": true
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: sys",
            "line": 3,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# test_python_bad.py - 有问题的Python代码示例",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": true
              },
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: unused_module  # 未使用的导入",
            "line": 4,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# test_python_bad.py - 有问题的Python代码示例",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": true
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 19,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 16,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": true
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "division_by_zero_risk",
            "severity": "warning",
            "message": "可能存在除零风险",
            "line": 31,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 28,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "def divide_numbers(a, b):",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    # 缺少异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 31,
                "content": "    result = a / b  # 可能除零错误",
                "is_issue_line": true
              },
              {
                "line_number": 32,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 33,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 34,
                "content": "# 全局变量（不好的实践）",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "global_variables",
            "severity": "warning",
            "message": "使用全局变量",
            "line": 38,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 35,
                "content": "global_var = \"I'm global\"",
                "is_issue_line": false
              },
              {
                "line_number": 36,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 37,
                "content": "def use_global():",
                "is_issue_line": false
              },
              {
                "line_number": 38,
                "content": "    global global_var",
                "is_issue_line": true
              },
              {
                "line_number": 39,
                "content": "    global_var = \"modified\"",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "全局变量会增加代码的复杂性和测试难度。建议使用函数参数或类属性。",
            "fix_suggestions": [
              "使用函数参数传递数据",
              "使用类属性",
              "使用单例模式"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 57,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 54,
                "content": "    return big_list",
                "is_issue_line": false
              },
              {
                "line_number": 55,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 56,
                "content": "# 缺少主函数保护",
                "is_issue_line": false
              },
              {
                "line_number": 57,
                "content": "print(\"This will always execute\")",
                "is_issue_line": true
              },
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "global_variables",
            "severity": "warning",
            "message": "使用全局变量",
            "line": 38,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 35,
                "content": "global_var = \"I'm global\"",
                "is_issue_line": false
              },
              {
                "line_number": 36,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 37,
                "content": "def use_global():",
                "is_issue_line": false
              },
              {
                "line_number": 38,
                "content": "    global global_var",
                "is_issue_line": true
              },
              {
                "line_number": 39,
                "content": "    global_var = \"modified\"",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "全局变量会增加代码的复杂性和测试难度。建议使用函数参数或类属性。",
            "fix_suggestions": [
              "使用函数参数传递数据",
              "使用类属性",
              "使用单例模式"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "文件操作未处理异常",
            "line": 45,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 42,
                "content": "# 不安全的文件操作",
                "is_issue_line": false
              },
              {
                "line_number": 43,
                "content": "def read_file(filename):",
                "is_issue_line": false
              },
              {
                "line_number": 44,
                "content": "    # 没有异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 45,
                "content": "    with open(filename, 'r') as f:",
                "is_issue_line": true
              },
              {
                "line_number": 46,
                "content": "        content = f.read()",
                "is_issue_line": false
              },
              {
                "line_number": 47,
                "content": "    return content",
                "is_issue_line": false
              },
              {
                "line_number": 48,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_type_conversion",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 19,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 16,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": true
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_type_conversion",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 57,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 54,
                "content": "    return big_list",
                "is_issue_line": false
              },
              {
                "line_number": 55,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 56,
                "content": "# 缺少主函数保护",
                "is_issue_line": false
              },
              {
                "line_number": 57,
                "content": "print(\"This will always execute\")",
                "is_issue_line": true
              },
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "memory_leak",
            "severity": "warning",
            "message": "可能存在内存泄漏",
            "line": 17,
            "file": "test_java.java",
            "language": "java",
            "code_snippet": [
              {
                "line_number": 14,
                "content": "        // 资源泄漏",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "        FileInputStream fis = null;",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "        try {",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "            fis = new FileInputStream(\"test.txt\");",
                "is_issue_line": true
              },
              {
                "line_number": 18,
                "content": "            // 处理文件",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "        } catch (IOException e) {",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "            e.printStackTrace();",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_java.java",
            "enhanced": true
          },
          {
            "type": "memory_leak",
            "severity": "warning",
            "message": "可能存在内存泄漏",
            "line": 25,
            "file": "test_java.java",
            "language": "java",
            "code_snippet": [
              {
                "line_number": 22,
                "content": "        // 忘记关闭文件流",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "        ",
                "is_issue_line": false
              },
              {
                "line_number": 24,
                "content": "        // 内存泄漏风险",
                "is_issue_line": false
              },
              {
                "line_number": 25,
                "content": "        List<String> list = new ArrayList<>();",
                "is_issue_line": true
              },
              {
                "line_number": 26,
                "content": "        for (int i = 0; i < 1000000; i++) {",
                "is_issue_line": false
              },
              {
                "line_number": 27,
                "content": "            list.add(\"item\" + i);",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "        }",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_java.java",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 bad_function 缺少参数验证",
            "line": 10,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": true
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "    x = 1",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "    y = 2",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 risky_function 缺少参数验证",
            "line": 17,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 14,
                "content": "    z = x + y",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    return z",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": true
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 process_user_data 缺少参数验证",
            "line": 23,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": true
              },
              {
                "line_number": 24,
                "content": "    # 缺少类型提示和文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 25,
                "content": "    # 缺少输入验证",
                "is_issue_line": false
              },
              {
                "line_number": 26,
                "content": "    processed = data * 2",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 divide_numbers 缺少参数验证",
            "line": 29,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 26,
                "content": "    processed = data * 2",
                "is_issue_line": false
              },
              {
                "line_number": 27,
                "content": "    return processed",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "def divide_numbers(a, b):",
                "is_issue_line": true
              },
              {
                "line_number": 30,
                "content": "    # 缺少异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 31,
                "content": "    result = a / b  # 可能除零错误",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "    return result",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 use_global 缺少参数验证",
            "line": 37,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 34,
                "content": "# 全局变量（不好的实践）",
                "is_issue_line": false
              },
              {
                "line_number": 35,
                "content": "global_var = \"I'm global\"",
                "is_issue_line": false
              },
              {
                "line_number": 36,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 37,
                "content": "def use_global():",
                "is_issue_line": true
              },
              {
                "line_number": 38,
                "content": "    global global_var",
                "is_issue_line": false
              },
              {
                "line_number": 39,
                "content": "    global_var = \"modified\"",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 read_file 缺少参数验证",
            "line": 43,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 42,
                "content": "# 不安全的文件操作",
                "is_issue_line": false
              },
              {
                "line_number": 43,
                "content": "def read_file(filename):",
                "is_issue_line": true
              },
              {
                "line_number": 44,
                "content": "    # 没有异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 45,
                "content": "    with open(filename, 'r') as f:",
                "is_issue_line": false
              },
              {
                "line_number": 46,
                "content": "        content = f.read()",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 create_large_list 缺少参数验证",
            "line": 50,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 47,
                "content": "    return content",
                "is_issue_line": false
              },
              {
                "line_number": 48,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 49,
                "content": "# 内存泄漏风险",
                "is_issue_line": false
              },
              {
                "line_number": 50,
                "content": "def create_large_list():",
                "is_issue_line": true
              },
              {
                "line_number": 51,
                "content": "    big_list = []",
                "is_issue_line": false
              },
              {
                "line_number": 52,
                "content": "    for i in range(1000000):",
                "is_issue_line": false
              },
              {
                "line_number": 53,
                "content": "        big_list.append(f\"item_{i}\")",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 format_string 缺少参数验证",
            "line": 60,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 57,
                "content": "print(\"This will always execute\")",
                "is_issue_line": false
              },
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": true
              },
              {
                "line_number": 61,
                "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                "is_issue_line": false
              },
              {
                "line_number": 62,
                "content": "    return query",
                "is_issue_line": false
              },
              {
                "line_number": 63,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 10,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": true
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "    x = 1",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "    y = 2",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 23,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": true
              },
              {
                "line_number": 24,
                "content": "    # 缺少类型提示和文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 25,
                "content": "    # 缺少输入验证",
                "is_issue_line": false
              },
              {
                "line_number": 26,
                "content": "    processed = data * 2",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 37,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 34,
                "content": "# 全局变量（不好的实践）",
                "is_issue_line": false
              },
              {
                "line_number": 35,
                "content": "global_var = \"I'm global\"",
                "is_issue_line": false
              },
              {
                "line_number": 36,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 37,
                "content": "def use_global():",
                "is_issue_line": true
              },
              {
                "line_number": 38,
                "content": "    global global_var",
                "is_issue_line": false
              },
              {
                "line_number": 39,
                "content": "    global_var = \"modified\"",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 43,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 42,
                "content": "# 不安全的文件操作",
                "is_issue_line": false
              },
              {
                "line_number": 43,
                "content": "def read_file(filename):",
                "is_issue_line": true
              },
              {
                "line_number": 44,
                "content": "    # 没有异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 45,
                "content": "    with open(filename, 'r') as f:",
                "is_issue_line": false
              },
              {
                "line_number": 46,
                "content": "        content = f.read()",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 50,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 47,
                "content": "    return content",
                "is_issue_line": false
              },
              {
                "line_number": 48,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 49,
                "content": "# 内存泄漏风险",
                "is_issue_line": false
              },
              {
                "line_number": 50,
                "content": "def create_large_list():",
                "is_issue_line": true
              },
              {
                "line_number": 51,
                "content": "    big_list = []",
                "is_issue_line": false
              },
              {
                "line_number": 52,
                "content": "    for i in range(1000000):",
                "is_issue_line": false
              },
              {
                "line_number": 53,
                "content": "        big_list.append(f\"item_{i}\")",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 60,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 57,
                "content": "print(\"This will always execute\")",
                "is_issue_line": false
              },
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": true
              },
              {
                "line_number": 61,
                "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                "is_issue_line": false
              },
              {
                "line_number": 62,
                "content": "    return query",
                "is_issue_line": false
              },
              {
                "line_number": 63,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 1000000",
            "line": 52,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 49,
                "content": "# 内存泄漏风险",
                "is_issue_line": false
              },
              {
                "line_number": 50,
                "content": "def create_large_list():",
                "is_issue_line": false
              },
              {
                "line_number": 51,
                "content": "    big_list = []",
                "is_issue_line": false
              },
              {
                "line_number": 52,
                "content": "    for i in range(1000000):",
                "is_issue_line": true
              },
              {
                "line_number": 53,
                "content": "        big_list.append(f\"item_{i}\")",
                "is_issue_line": false
              },
              {
                "line_number": 54,
                "content": "    return big_list",
                "is_issue_line": false
              },
              {
                "line_number": 55,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "LOW",
            "message": "Possible hardcoded password: 'admin123'",
            "file": "test_python_bad.py",
            "line": 8,
            "column": 0,
            "rule": "B105",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "MEDIUM",
            "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
            "file": "test_python_bad.py",
            "line": 20,
            "column": 0,
            "rule": "B307",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "MEDIUM",
            "message": "Possible SQL injection vector through string-based query construction.",
            "file": "test_python_bad.py",
            "line": 61,
            "column": 0,
            "rule": "B608",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 61,
                "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                "is_issue_line": true
              },
              {
                "line_number": 62,
                "content": "    return query",
                "is_issue_line": false
              },
              {
                "line_number": 63,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 64,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          }
        ],
        "detection_tools": [
          "custom_analyzer",
          "bandit",
          "mypy",
          "ai_analyzer"
        ],
        "analysis_time": 23.164006999999998,
        "summary": {
          "error_count": 8,
          "warning_count": 13,
          "info_count": 15
        },
        "languages_detected": [
          "python",
          "java"
        ]
      },
      "report": {
        "summary": {
          "error_count": 8,
          "warning_count": 13,
          "info_count": 15
        },
        "issues_by_type": {
          "hardcoded_secrets": 5,
          "unsafe_eval": 2,
          "mypy": 1,
          "unused_import": 3,
          "unhandled_exception": 3,
          "division_by_zero_risk": 1,
          "global_variables": 2,
          "unhandled_type_conversion": 2,
          "memory_leak": 2,
          "missing_parameter_validation": 8,
          "missing_docstring": 6,
          "magic_number": 1,
          "bandit": 3
        },
        "issues_by_severity": {
          "error": 8,
          "warning": 13,
          "info": 15
        },
        "recommendations": [
          "发现严重错误，建议优先修复",
          "警告数量较多，建议进行代码审查"
        ],
        "priority_issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 7,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 20,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 7,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的SECRET",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "temp_extract\\project_20250928_162008\\test_zip\\test_python_bad.py",
            "enhanced": true
          }
        ]
      },
      "timestamp": "2025-09-28T16:20:32.098596"
    },
    "error": null,
    "completed_at": "2025-09-28T16:20:32.099273"
  },
  "task_56ed6d201ac8": {
    "task_id": "task_56ed6d201ac8",
    "status": "completed",
    "created_at": "2025-09-28T16:21:13.135857",
    "started_at": "2025-09-28T16:21:13.135857",
    "result": {
      "success": true,
      "task_id": "task_56ed6d201ac8",
      "detection_results": {
        "file_path": "uploads\\test_python_with_defects.py",
        "language": "python",
        "total_issues": 23,
        "issues": [
          {
            "type": "division_by_zero_risk",
            "severity": "warning",
            "message": "可能存在除零风险",
            "line": 6,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 3,
                "content": "    # 缺陷1：未处理空列表情况",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "    total = sum(numbers)",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "    # 缺陷2：整除可能导致结果不准确",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return total / len(numbers)",
                "is_issue_line": true
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "def process_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 14,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 11,
                "content": "    result = []",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "    for item in data:",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "        # 缺陷4：未处理字符串转整数失败的情况",
                "is_issue_line": false
              },
              {
                "line_number": 14,
                "content": "        result.append(int(item) * 2)",
                "is_issue_line": true
              },
              {
                "line_number": 15,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "JSON解析未处理异常",
            "line": 25,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 22,
                "content": "        config = f.read()",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "    # 缺陷7：假设配置一定是JSON格式但未验证",
                "is_issue_line": false
              },
              {
                "line_number": 24,
                "content": "    import json",
                "is_issue_line": false
              },
              {
                "line_number": 25,
                "content": "    return json.loads(config)",
                "is_issue_line": true
              },
              {
                "line_number": 26,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 27,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "class DataProcessor:",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 41,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 38,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 39,
                "content": "    # 缺陷10：测试用例不完整，未覆盖异常场景",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    avg = calculate_average([1, 2, 3])",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "    print(f\"Average: {avg}\")",
                "is_issue_line": true
              },
              {
                "line_number": 42,
                "content": "    ",
                "is_issue_line": false
              },
              {
                "line_number": 43,
                "content": "    processed = process_data([\"4\", \"5\", \"6\"])",
                "is_issue_line": false
              },
              {
                "line_number": 44,
                "content": "    print(f\"Processed: {processed}\")",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 44,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 41,
                "content": "    print(f\"Average: {avg}\")",
                "is_issue_line": false
              },
              {
                "line_number": 42,
                "content": "    ",
                "is_issue_line": false
              },
              {
                "line_number": 43,
                "content": "    processed = process_data([\"4\", \"5\", \"6\"])",
                "is_issue_line": false
              },
              {
                "line_number": 44,
                "content": "    print(f\"Processed: {processed}\")",
                "is_issue_line": true
              },
              {
                "line_number": 45,
                "content": "    ",
                "is_issue_line": false
              },
              {
                "line_number": 46,
                "content": "    config = read_config(\"config.json\")",
                "is_issue_line": false
              },
              {
                "line_number": 47,
                "content": "    print(f\"Config: {config}\")",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 47,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 44,
                "content": "    print(f\"Processed: {processed}\")",
                "is_issue_line": false
              },
              {
                "line_number": 45,
                "content": "    ",
                "is_issue_line": false
              },
              {
                "line_number": 46,
                "content": "    config = read_config(\"config.json\")",
                "is_issue_line": false
              },
              {
                "line_number": 47,
                "content": "    print(f\"Config: {config}\")",
                "is_issue_line": true
              },
              {
                "line_number": 48,
                "content": "    ",
                "is_issue_line": false
              },
              {
                "line_number": 49,
                "content": "    processor = DataProcessor(5)",
                "is_issue_line": false
              },
              {
                "line_number": 50,
                "content": "    print(f\"Processed value: {processor.process(10)}\")",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 50,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 47,
                "content": "    print(f\"Config: {config}\")",
                "is_issue_line": false
              },
              {
                "line_number": 48,
                "content": "    ",
                "is_issue_line": false
              },
              {
                "line_number": 49,
                "content": "    processor = DataProcessor(5)",
                "is_issue_line": false
              },
              {
                "line_number": 50,
                "content": "    print(f\"Processed value: {processor.process(10)}\")",
                "is_issue_line": true
              },
              {
                "line_number": 51,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "potential_division_by_zero",
            "severity": "warning",
            "message": "可能存在除零错误",
            "line": 6,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 3,
                "content": "    # 缺陷1：未处理空列表情况",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "    total = sum(numbers)",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "    # 缺陷2：整除可能导致结果不准确",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return total / len(numbers)",
                "is_issue_line": true
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "def process_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "文件操作未处理异常",
            "line": 20,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 17,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "def read_config(config_path):",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    # 缺陷5：未处理文件不存在的异常",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    with open(config_path, 'r') as f:",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "        # 缺陷6：未关闭文件（虽然with会自动关闭，但这里模拟逻辑缺陷）",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "        config = f.read()",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "    # 缺陷7：假设配置一定是JSON格式但未验证",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "unhandled_type_conversion",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 14,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 11,
                "content": "    result = []",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "    for item in data:",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "        # 缺陷4：未处理字符串转整数失败的情况",
                "is_issue_line": false
              },
              {
                "line_number": 14,
                "content": "        result.append(int(item) * 2)",
                "is_issue_line": true
              },
              {
                "line_number": 15,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "unhandled_type_conversion",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 41,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 38,
                "content": "if __name__ == \"__main__\":",
                "is_issue_line": false
              },
              {
                "line_number": 39,
                "content": "    # 缺陷10：测试用例不完整，未覆盖异常场景",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    avg = calculate_average([1, 2, 3])",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "    print(f\"Average: {avg}\")",
                "is_issue_line": true
              },
              {
                "line_number": 42,
                "content": "    ",
                "is_issue_line": false
              },
              {
                "line_number": 43,
                "content": "    processed = process_data([\"4\", \"5\", \"6\"])",
                "is_issue_line": false
              },
              {
                "line_number": 44,
                "content": "    print(f\"Processed: {processed}\")",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "unhandled_type_conversion",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 44,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 41,
                "content": "    print(f\"Average: {avg}\")",
                "is_issue_line": false
              },
              {
                "line_number": 42,
                "content": "    ",
                "is_issue_line": false
              },
              {
                "line_number": 43,
                "content": "    processed = process_data([\"4\", \"5\", \"6\"])",
                "is_issue_line": false
              },
              {
                "line_number": 44,
                "content": "    print(f\"Processed: {processed}\")",
                "is_issue_line": true
              },
              {
                "line_number": 45,
                "content": "    ",
                "is_issue_line": false
              },
              {
                "line_number": 46,
                "content": "    config = read_config(\"config.json\")",
                "is_issue_line": false
              },
              {
                "line_number": 47,
                "content": "    print(f\"Config: {config}\")",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "unhandled_type_conversion",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 47,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 44,
                "content": "    print(f\"Processed: {processed}\")",
                "is_issue_line": false
              },
              {
                "line_number": 45,
                "content": "    ",
                "is_issue_line": false
              },
              {
                "line_number": 46,
                "content": "    config = read_config(\"config.json\")",
                "is_issue_line": false
              },
              {
                "line_number": 47,
                "content": "    print(f\"Config: {config}\")",
                "is_issue_line": true
              },
              {
                "line_number": 48,
                "content": "    ",
                "is_issue_line": false
              },
              {
                "line_number": 49,
                "content": "    processor = DataProcessor(5)",
                "is_issue_line": false
              },
              {
                "line_number": 50,
                "content": "    print(f\"Processed value: {processor.process(10)}\")",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "unhandled_type_conversion",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 50,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 47,
                "content": "    print(f\"Config: {config}\")",
                "is_issue_line": false
              },
              {
                "line_number": 48,
                "content": "    ",
                "is_issue_line": false
              },
              {
                "line_number": 49,
                "content": "    processor = DataProcessor(5)",
                "is_issue_line": false
              },
              {
                "line_number": 50,
                "content": "    print(f\"Processed value: {processor.process(10)}\")",
                "is_issue_line": true
              },
              {
                "line_number": 51,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "unhandled_json_parse",
            "severity": "warning",
            "message": "JSON解析未处理异常",
            "line": 25,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 22,
                "content": "        config = f.read()",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "    # 缺陷7：假设配置一定是JSON格式但未验证",
                "is_issue_line": false
              },
              {
                "line_number": 24,
                "content": "    import json",
                "is_issue_line": false
              },
              {
                "line_number": 25,
                "content": "    return json.loads(config)",
                "is_issue_line": true
              },
              {
                "line_number": 26,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 27,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "class DataProcessor:",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "empty_list_handling",
            "severity": "warning",
            "message": "未处理空列表情况",
            "line": 4,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# 存在多种缺陷的示例代码",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "def calculate_average(numbers):",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "    # 缺陷1：未处理空列表情况",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "    total = sum(numbers)",
                "is_issue_line": true
              },
              {
                "line_number": 5,
                "content": "    # 缺陷2：整除可能导致结果不准确",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "    return total / len(numbers)",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 calculate_average 缺少参数验证",
            "line": 2,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# 存在多种缺陷的示例代码",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "def calculate_average(numbers):",
                "is_issue_line": true
              },
              {
                "line_number": 3,
                "content": "    # 缺陷1：未处理空列表情况",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "    total = sum(numbers)",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "    # 缺陷2：整除可能导致结果不准确",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 process_data 缺少参数验证",
            "line": 9,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 6,
                "content": "    return total / len(numbers)",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "def process_data(data):",
                "is_issue_line": true
              },
              {
                "line_number": 10,
                "content": "    # 缺陷3：未判断数据类型，可能传入非列表参数",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    result = []",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "    for item in data:",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 read_config 缺少参数验证",
            "line": 18,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 15,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "def read_config(config_path):",
                "is_issue_line": true
              },
              {
                "line_number": 19,
                "content": "    # 缺陷5：未处理文件不存在的异常",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    with open(config_path, 'r') as f:",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "        # 缺陷6：未关闭文件（虽然with会自动关闭，但这里模拟逻辑缺陷）",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 process 缺少参数验证",
            "line": 33,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 30,
                "content": "        # 缺陷8：未验证threshold的有效性",
                "is_issue_line": false
              },
              {
                "line_number": 31,
                "content": "        self.threshold = threshold",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 33,
                "content": "    def process(self, value):",
                "is_issue_line": true
              },
              {
                "line_number": 34,
                "content": "        # 缺陷9：可能导致除零错误",
                "is_issue_line": false
              },
              {
                "line_number": 35,
                "content": "        return value / self.threshold if value else 0",
                "is_issue_line": false
              },
              {
                "line_number": 36,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 2,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# 存在多种缺陷的示例代码",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "def calculate_average(numbers):",
                "is_issue_line": true
              },
              {
                "line_number": 3,
                "content": "    # 缺陷1：未处理空列表情况",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "    total = sum(numbers)",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "    # 缺陷2：整除可能导致结果不准确",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 18,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 15,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "def read_config(config_path):",
                "is_issue_line": true
              },
              {
                "line_number": 19,
                "content": "    # 缺陷5：未处理文件不存在的异常",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    with open(config_path, 'r') as f:",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "        # 缺陷6：未关闭文件（虽然with会自动关闭，但这里模拟逻辑缺陷）",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 29,
            "file": "test_python_with_defects.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 26,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 27,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "class DataProcessor:",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "    def __init__(self, threshold):",
                "is_issue_line": true
              },
              {
                "line_number": 30,
                "content": "        # 缺陷8：未验证threshold的有效性",
                "is_issue_line": false
              },
              {
                "line_number": 31,
                "content": "        self.threshold = threshold",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_with_defects.py",
            "enhanced": true
          }
        ],
        "detection_tools": [
          "custom_analyzer",
          "bandit",
          "mypy"
        ],
        "analysis_time": 2.079447,
        "summary": {
          "error_count": 0,
          "warning_count": 16,
          "info_count": 7
        },
        "enhanced": true
      },
      "report": {
        "summary": {
          "error_count": 0,
          "warning_count": 16,
          "info_count": 7
        },
        "issues_by_type": {
          "division_by_zero_risk": 1,
          "unhandled_exception": 7,
          "potential_division_by_zero": 1,
          "unhandled_type_conversion": 5,
          "unhandled_json_parse": 1,
          "empty_list_handling": 1,
          "missing_parameter_validation": 4,
          "missing_docstring": 3
        },
        "issues_by_severity": {
          "error": 0,
          "warning": 16,
          "info": 7
        },
        "recommendations": [
          "警告数量较多，建议进行代码审查"
        ],
        "priority_issues": []
      },
      "timestamp": "2025-09-28T16:21:15.451901"
    },
    "error": null,
    "completed_at": "2025-09-28T16:21:15.451901"
  },
  "task_a9f11e144ef0": {
    "task_id": "task_a9f11e144ef0",
    "status": "completed",
    "created_at": "2025-09-29T18:21:47.869324",
    "started_at": "2025-09-29T18:21:47.869324",
    "result": {
      "success": true,
      "task_id": "task_a9f11e144ef0",
      "detection_results": {
        "file_path": "uploads\\test_python_bad.py",
        "language": "python",
        "total_issues": 37,
        "issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 7,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 20,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 7,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的SECRET",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的PASSWORD",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 20,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "mypy",
            "severity": "error",
            "message": "Cannot find implementation or library stub for module named \"unused_module\"  [import-not-found]",
            "file": "test_python_bad.py",
            "line": 4,
            "column": 0,
            "rule": "mypy",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# test_python_bad.py - 有问题的Python代码示例",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": true
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: os",
            "line": 2,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# test_python_bad.py - 有问题的Python代码示例",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": true
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: sys",
            "line": 3,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# test_python_bad.py - 有问题的Python代码示例",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": true
              },
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unused_import",
            "severity": "warning",
            "message": "可能未使用的导入: unused_module  # 未使用的导入",
            "line": 4,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 1,
                "content": "# test_python_bad.py - 有问题的Python代码示例",
                "is_issue_line": false
              },
              {
                "line_number": 2,
                "content": "import os",
                "is_issue_line": false
              },
              {
                "line_number": 3,
                "content": "import sys",
                "is_issue_line": false
              },
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": true
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              }
            ],
            "detailed_description": "未使用的导入语句会占用内存空间并可能影响代码的可读性。建议删除未使用的导入。",
            "fix_suggestions": [
              "删除未使用的导入语句",
              "检查是否有其他文件需要这个导入",
              "使用IDE的自动清理功能"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 19,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 16,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": true
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "division_by_zero_risk",
            "severity": "warning",
            "message": "可能存在除零风险",
            "line": 31,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 28,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "def divide_numbers(a, b):",
                "is_issue_line": false
              },
              {
                "line_number": 30,
                "content": "    # 缺少异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 31,
                "content": "    result = a / b  # 可能除零错误",
                "is_issue_line": true
              },
              {
                "line_number": 32,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 33,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 34,
                "content": "# 全局变量（不好的实践）",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "global_variables",
            "severity": "warning",
            "message": "使用全局变量",
            "line": 38,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 35,
                "content": "global_var = \"I'm global\"",
                "is_issue_line": false
              },
              {
                "line_number": 36,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 37,
                "content": "def use_global():",
                "is_issue_line": false
              },
              {
                "line_number": 38,
                "content": "    global global_var",
                "is_issue_line": true
              },
              {
                "line_number": 39,
                "content": "    global_var = \"modified\"",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "全局变量会增加代码的复杂性和测试难度。建议使用函数参数或类属性。",
            "fix_suggestions": [
              "使用函数参数传递数据",
              "使用类属性",
              "使用单例模式"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 57,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 54,
                "content": "    return big_list",
                "is_issue_line": false
              },
              {
                "line_number": 55,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 56,
                "content": "# 缺少主函数保护",
                "is_issue_line": false
              },
              {
                "line_number": 57,
                "content": "print(\"This will always execute\")",
                "is_issue_line": true
              },
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "global_variables",
            "severity": "warning",
            "message": "使用全局变量",
            "line": 38,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 35,
                "content": "global_var = \"I'm global\"",
                "is_issue_line": false
              },
              {
                "line_number": 36,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 37,
                "content": "def use_global():",
                "is_issue_line": false
              },
              {
                "line_number": 38,
                "content": "    global global_var",
                "is_issue_line": true
              },
              {
                "line_number": 39,
                "content": "    global_var = \"modified\"",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "全局变量会增加代码的复杂性和测试难度。建议使用函数参数或类属性。",
            "fix_suggestions": [
              "使用函数参数传递数据",
              "使用类属性",
              "使用单例模式"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_exception",
            "severity": "warning",
            "message": "文件操作未处理异常",
            "line": 45,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 42,
                "content": "# 不安全的文件操作",
                "is_issue_line": false
              },
              {
                "line_number": 43,
                "content": "def read_file(filename):",
                "is_issue_line": false
              },
              {
                "line_number": 44,
                "content": "    # 没有异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 45,
                "content": "    with open(filename, 'r') as f:",
                "is_issue_line": true
              },
              {
                "line_number": 46,
                "content": "        content = f.read()",
                "is_issue_line": false
              },
              {
                "line_number": 47,
                "content": "    return content",
                "is_issue_line": false
              },
              {
                "line_number": 48,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_type_conversion",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 19,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 16,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": true
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unhandled_type_conversion",
            "severity": "warning",
            "message": "类型转换未处理异常",
            "line": 57,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 54,
                "content": "    return big_list",
                "is_issue_line": false
              },
              {
                "line_number": 55,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 56,
                "content": "# 缺少主函数保护",
                "is_issue_line": false
              },
              {
                "line_number": 57,
                "content": "print(\"This will always execute\")",
                "is_issue_line": true
              },
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 2,
              "name": "警告",
              "color": "#ff8800"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 bad_function 缺少参数验证",
            "line": 10,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": true
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "    x = 1",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "    y = 2",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 risky_function 缺少参数验证",
            "line": 17,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 14,
                "content": "    z = x + y",
                "is_issue_line": false
              },
              {
                "line_number": 15,
                "content": "    return z",
                "is_issue_line": false
              },
              {
                "line_number": 16,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": true
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 process_user_data 缺少参数验证",
            "line": 23,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": true
              },
              {
                "line_number": 24,
                "content": "    # 缺少类型提示和文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 25,
                "content": "    # 缺少输入验证",
                "is_issue_line": false
              },
              {
                "line_number": 26,
                "content": "    processed = data * 2",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 divide_numbers 缺少参数验证",
            "line": 29,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 26,
                "content": "    processed = data * 2",
                "is_issue_line": false
              },
              {
                "line_number": 27,
                "content": "    return processed",
                "is_issue_line": false
              },
              {
                "line_number": 28,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 29,
                "content": "def divide_numbers(a, b):",
                "is_issue_line": true
              },
              {
                "line_number": 30,
                "content": "    # 缺少异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 31,
                "content": "    result = a / b  # 可能除零错误",
                "is_issue_line": false
              },
              {
                "line_number": 32,
                "content": "    return result",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 use_global 缺少参数验证",
            "line": 37,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 34,
                "content": "# 全局变量（不好的实践）",
                "is_issue_line": false
              },
              {
                "line_number": 35,
                "content": "global_var = \"I'm global\"",
                "is_issue_line": false
              },
              {
                "line_number": 36,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 37,
                "content": "def use_global():",
                "is_issue_line": true
              },
              {
                "line_number": 38,
                "content": "    global global_var",
                "is_issue_line": false
              },
              {
                "line_number": 39,
                "content": "    global_var = \"modified\"",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 read_file 缺少参数验证",
            "line": 43,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 42,
                "content": "# 不安全的文件操作",
                "is_issue_line": false
              },
              {
                "line_number": 43,
                "content": "def read_file(filename):",
                "is_issue_line": true
              },
              {
                "line_number": 44,
                "content": "    # 没有异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 45,
                "content": "    with open(filename, 'r') as f:",
                "is_issue_line": false
              },
              {
                "line_number": 46,
                "content": "        content = f.read()",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 create_large_list 缺少参数验证",
            "line": 50,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 47,
                "content": "    return content",
                "is_issue_line": false
              },
              {
                "line_number": 48,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 49,
                "content": "# 内存泄漏风险",
                "is_issue_line": false
              },
              {
                "line_number": 50,
                "content": "def create_large_list():",
                "is_issue_line": true
              },
              {
                "line_number": 51,
                "content": "    big_list = []",
                "is_issue_line": false
              },
              {
                "line_number": 52,
                "content": "    for i in range(1000000):",
                "is_issue_line": false
              },
              {
                "line_number": 53,
                "content": "        big_list.append(f\"item_{i}\")",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_parameter_validation",
            "severity": "info",
            "message": "函数 format_string 缺少参数验证",
            "line": 60,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 57,
                "content": "print(\"This will always execute\")",
                "is_issue_line": false
              },
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": true
              },
              {
                "line_number": 61,
                "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                "is_issue_line": false
              },
              {
                "line_number": 62,
                "content": "    return query",
                "is_issue_line": false
              },
              {
                "line_number": 63,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 10,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": true
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 12,
                "content": "    x = 1",
                "is_issue_line": false
              },
              {
                "line_number": 13,
                "content": "    y = 2",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 23,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": false
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": true
              },
              {
                "line_number": 24,
                "content": "    # 缺少类型提示和文档字符串",
                "is_issue_line": false
              },
              {
                "line_number": 25,
                "content": "    # 缺少输入验证",
                "is_issue_line": false
              },
              {
                "line_number": 26,
                "content": "    processed = data * 2",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 37,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 34,
                "content": "# 全局变量（不好的实践）",
                "is_issue_line": false
              },
              {
                "line_number": 35,
                "content": "global_var = \"I'm global\"",
                "is_issue_line": false
              },
              {
                "line_number": 36,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 37,
                "content": "def use_global():",
                "is_issue_line": true
              },
              {
                "line_number": 38,
                "content": "    global global_var",
                "is_issue_line": false
              },
              {
                "line_number": 39,
                "content": "    global_var = \"modified\"",
                "is_issue_line": false
              },
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 43,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 40,
                "content": "    return global_var",
                "is_issue_line": false
              },
              {
                "line_number": 41,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 42,
                "content": "# 不安全的文件操作",
                "is_issue_line": false
              },
              {
                "line_number": 43,
                "content": "def read_file(filename):",
                "is_issue_line": true
              },
              {
                "line_number": 44,
                "content": "    # 没有异常处理",
                "is_issue_line": false
              },
              {
                "line_number": 45,
                "content": "    with open(filename, 'r') as f:",
                "is_issue_line": false
              },
              {
                "line_number": 46,
                "content": "        content = f.read()",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 50,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 47,
                "content": "    return content",
                "is_issue_line": false
              },
              {
                "line_number": 48,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 49,
                "content": "# 内存泄漏风险",
                "is_issue_line": false
              },
              {
                "line_number": 50,
                "content": "def create_large_list():",
                "is_issue_line": true
              },
              {
                "line_number": 51,
                "content": "    big_list = []",
                "is_issue_line": false
              },
              {
                "line_number": 52,
                "content": "    for i in range(1000000):",
                "is_issue_line": false
              },
              {
                "line_number": 53,
                "content": "        big_list.append(f\"item_{i}\")",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "missing_docstring",
            "severity": "info",
            "message": "函数缺少文档字符串",
            "line": 60,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 57,
                "content": "print(\"This will always execute\")",
                "is_issue_line": false
              },
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": true
              },
              {
                "line_number": 61,
                "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                "is_issue_line": false
              },
              {
                "line_number": 62,
                "content": "    return query",
                "is_issue_line": false
              },
              {
                "line_number": 63,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "magic_number",
            "severity": "info",
            "message": "魔法数字: 1000000",
            "line": 52,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 49,
                "content": "# 内存泄漏风险",
                "is_issue_line": false
              },
              {
                "line_number": 50,
                "content": "def create_large_list():",
                "is_issue_line": false
              },
              {
                "line_number": 51,
                "content": "    big_list = []",
                "is_issue_line": false
              },
              {
                "line_number": 52,
                "content": "    for i in range(1000000):",
                "is_issue_line": true
              },
              {
                "line_number": 53,
                "content": "        big_list.append(f\"item_{i}\")",
                "is_issue_line": false
              },
              {
                "line_number": 54,
                "content": "    return big_list",
                "is_issue_line": false
              },
              {
                "line_number": 55,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {
              "level": 3,
              "name": "信息",
              "color": "#4488ff"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "LOW",
            "message": "Possible hardcoded password: 'admin123'",
            "file": "test_python_bad.py",
            "line": 8,
            "column": 0,
            "rule": "B105",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "MEDIUM",
            "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
            "file": "test_python_bad.py",
            "line": 20,
            "column": 0,
            "rule": "B307",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "bandit",
            "severity": "MEDIUM",
            "message": "Possible SQL injection vector through string-based query construction.",
            "file": "test_python_bad.py",
            "line": 61,
            "column": 0,
            "rule": "B608",
            "language": "python",
            "code_snippet": [
              {
                "line_number": 58,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 59,
                "content": "# 不安全的字符串格式化",
                "is_issue_line": false
              },
              {
                "line_number": 60,
                "content": "def format_string(user_input):",
                "is_issue_line": false
              },
              {
                "line_number": 61,
                "content": "    query = \"SELECT * FROM users WHERE name = '%s'\" % user_input  # SQL注入风险",
                "is_issue_line": true
              },
              {
                "line_number": 62,
                "content": "    return query",
                "is_issue_line": false
              },
              {
                "line_number": 63,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 64,
                "content": "",
                "is_issue_line": false
              }
            ],
            "detailed_description": "这是一个代码质量问题，建议进行相应的修复。",
            "fix_suggestions": [
              "建议根据具体情况进行修复"
            ],
            "severity_info": {},
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          }
        ],
        "detection_tools": [
          "custom_analyzer",
          "bandit",
          "mypy"
        ],
        "analysis_time": 5.352348,
        "summary": {
          "error_count": 8,
          "warning_count": 11,
          "info_count": 15
        },
        "enhanced": true
      },
      "report": {
        "summary": {
          "error_count": 8,
          "warning_count": 11,
          "info_count": 15
        },
        "issues_by_type": {
          "hardcoded_secrets": 5,
          "unsafe_eval": 2,
          "mypy": 1,
          "unused_import": 3,
          "unhandled_exception": 3,
          "division_by_zero_risk": 1,
          "global_variables": 2,
          "unhandled_type_conversion": 2,
          "missing_parameter_validation": 8,
          "missing_docstring": 6,
          "magic_number": 1,
          "bandit": 3
        },
        "issues_by_severity": {
          "error": 8,
          "warning": 11,
          "info": 15
        },
        "recommendations": [
          "发现严重错误，建议优先修复",
          "警告数量较多，建议进行代码审查"
        ],
        "priority_issues": [
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 7,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的密钥或密码",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "unsafe_eval",
            "severity": "error",
            "message": "不安全的eval使用",
            "line": 20,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 17,
                "content": "def risky_function():",
                "is_issue_line": false
              },
              {
                "line_number": 18,
                "content": "    # 不安全的eval使用",
                "is_issue_line": false
              },
              {
                "line_number": 19,
                "content": "    user_input = \"print('Hello')\"",
                "is_issue_line": false
              },
              {
                "line_number": 20,
                "content": "    result = eval(user_input)  # 安全风险",
                "is_issue_line": true
              },
              {
                "line_number": 21,
                "content": "    return result",
                "is_issue_line": false
              },
              {
                "line_number": 22,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 23,
                "content": "def process_user_data(data):",
                "is_issue_line": false
              }
            ],
            "detailed_description": "使用eval()函数执行用户输入存在代码注入风险，可能导致系统被攻击。建议使用更安全的方法。",
            "fix_suggestions": [
              "使用ast.literal_eval()替代eval()",
              "使用json.loads()解析JSON数据",
              "使用专门的解析库"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的API_KEY",
            "line": 7,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 4,
                "content": "import unused_module  # 未使用的导入",
                "is_issue_line": false
              },
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": true
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": false
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          },
          {
            "type": "hardcoded_secrets",
            "severity": "error",
            "message": "发现硬编码的SECRET",
            "line": 8,
            "file": "test_python_bad.py",
            "language": "python",
            "column": 0,
            "code_snippet": [
              {
                "line_number": 5,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 6,
                "content": "# 硬编码的API密钥",
                "is_issue_line": false
              },
              {
                "line_number": 7,
                "content": "API_KEY = \"sk-1234567890abcdef\"",
                "is_issue_line": false
              },
              {
                "line_number": 8,
                "content": "SECRET_PASSWORD = \"admin123\"",
                "is_issue_line": true
              },
              {
                "line_number": 9,
                "content": "",
                "is_issue_line": false
              },
              {
                "line_number": 10,
                "content": "def bad_function():",
                "is_issue_line": false
              },
              {
                "line_number": 11,
                "content": "    # 缺少文档字符串",
                "is_issue_line": false
              }
            ],
            "detailed_description": "硬编码的密钥、密码或API密钥存在安全风险，可能被恶意用户获取。建议使用环境变量或配置文件。",
            "fix_suggestions": [
              "使用环境变量存储敏感信息",
              "使用配置文件（不提交到版本控制）",
              "使用密钥管理服务"
            ],
            "severity_info": {
              "level": 1,
              "name": "错误",
              "color": "#ff4444"
            },
            "file_path": "uploads\\test_python_bad.py",
            "enhanced": true
          }
        ]
      },
      "timestamp": "2025-09-29T18:21:53.499675"
    },
    "error": null,
    "completed_at": "2025-09-29T18:21:53.499675"
  },
  "task_706d0d0b1f69": {
    "task_id": "task_706d0d0b1f69",
    "status": "completed",
    "created_at": "2025-09-29T18:31:56.646122",
    "started_at": "2025-09-29T18:31:56.646122",
    "result": {
      "success": true,
      "task_id": "task_706d0d0b1f69",
      "detection_results": {
        "project_path": "uploads\\test_project_with_issues.zip",
        "total_issues": 0,
        "issues": [],
        "files_analyzed": [],
        "summary": {
          "error_count": 0,
          "warning_count": 0,
          "info_count": 0
        }
      },
      "report": {
        "summary": {
          "error_count": 0,
          "warning_count": 0,
          "info_count": 0
        },
        "issues_by_type": {},
        "issues_by_severity": {
          "error": 0,
          "warning": 0,
          "info": 0
        },
        "recommendations": [],
        "priority_issues": []
      },
      "timestamp": "2025-09-29T18:31:56.716908"
    },
    "error": null,
    "completed_at": "2025-09-29T18:31:56.716908"
  },
  "task_1781349f8149": {
    "task_id": "task_1781349f8149",
    "status": "completed",
    "created_at": "2025-09-29T18:32:25.143511",
    "started_at": "2025-09-29T18:32:25.143511",
    "result": {
      "success": true,
      "task_id": "task_1781349f8149",
      "detection_results": {
        "project_path": "uploads\\test_zip.zip",
        "total_issues": 0,
        "issues": [],
        "files_analyzed": [],
        "summary": {
          "error_count": 0,
          "warning_count": 0,
          "info_count": 0
        }
      },
      "report": {
        "summary": {
          "error_count": 0,
          "warning_count": 0,
          "info_count": 0
        },
        "issues_by_type": {},
        "issues_by_severity": {
          "error": 0,
          "warning": 0,
          "info": 0
        },
        "recommendations": [],
        "priority_issues": []
      },
      "timestamp": "2025-09-29T18:32:25.255093"
    },
    "error": null,
    "completed_at": "2025-09-29T18:32:25.255093"
  },
  "task_12b3ae17c200": {
    "task_id": "task_12b3ae17c200",
    "status": "completed",
    "created_at": "2025-09-29T18:35:51.082419",
    "started_at": "2025-09-29T18:35:51.082419",
    "result": {
      "success": true,
      "task_id": "task_12b3ae17c200",
      "detection_results": {
        "project_path": "uploads\\test_project_with_issues.zip",
        "total_issues": 0,
        "issues": [],
        "files_analyzed": [],
        "summary": {
          "error_count": 0,
          "warning_count": 0,
          "info_count": 0
        }
      },
      "report": {
        "summary": {
          "error_count": 0,
          "warning_count": 0,
          "info_count": 0
        },
        "issues_by_type": {},
        "issues_by_severity": {
          "error": 0,
          "warning": 0,
          "info": 0
        },
        "recommendations": [],
        "priority_issues": []
      },
      "timestamp": "2025-09-29T18:35:51.430749"
    },
    "error": null,
    "completed_at": "2025-09-29T18:35:51.430749"
  }
}